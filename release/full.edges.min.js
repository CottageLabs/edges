var es={specialChars:["\\","+","-","=","&&","||",">","<","!","(",")","{","}","[","]","^",'"',"~","*","?",":","/"],specialCharsSubSet:["\\","+","-","=","&&","||",">","<","!","(",")","{","}","[","]","^","~","?",":","/"],characterPairs:['"'],distanceUnits:["km","mi","miles","in","inch","yd","yards","kilometers","mm","millimeters","cm","centimeters","m","meters"],aggregationFactory:function(t,e){var i={terms:es.newTermsAggregation,range:es.newRangeAggregation,geo_distance:es.newGeoDistanceAggregation,date_histogram:es.newDateHistogramAggregation,stats:es.StatsAggregation};return i[t]?i[t](e):void 0},filterFactory:function(t,e){var i={query_string:es.newQueryString,term:es.newTermFilter,terms:es.newTermsFilter,range:es.newRangeFilter,geo_distance_range:es.newGeoDistanceRangeFilter};return i[t]?i[t](e):void 0},newQuery:function(t){return t||(t={}),new es.Query(t)},Query:function(t){this.filtered=t.filtered||!0,this.size=void 0!==t.size?t.size:!1,this.from=t.from||!1,this.fields=t.fields||[],this.aggs=t.aggs||[],this.must=t.must||[],this.queryString=!1,this.sort=[],this.source=t.source||!1,this.should=t.should||[],this.mustNot=t.mustNot||[],this.partialFields=t.partialFields||!1,this.scriptFields=t.scriptFields||!1,this.minimumShouldMatch=t.minimumShouldMatch||!1,this.partialFields=t.partialFields||!1,this.scriptFields=t.scriptFields||!1,this.facets=t.facets||[],this.getSize=function(){return void 0!==this.size&&this.size!==!1?this.size:10},this.getFrom=function(){return this.from?this.from:0},this.addField=function(t){-1===$.inArray(t,this.fields)&&this.fields.push(t)},this.setQueryString=function(t){var e=t;t instanceof es.QueryString||(e=$.isPlainObject(t)?es.newQueryString(t):es.newQueryString({queryString:t})),this.queryString=e},this.getQueryString=function(){return this.queryString},this.removeQueryString=function(){this.queryString=!1},this.setSortBy=function(t){this.sort=[];var e=t;$.isArray(t)||(e=[t]);for(var i=0;i<e.length;i++)this.addSortBy(e[i])},this.addSortBy=function(t){var e=t;t instanceof es.Sort||(e=es.newSort(t));for(var i=0;i<this.sort.length;i++){var s=this.sort[i];if(s.field===e.field)return}this.sort.push(e)},this.prependSortBy=function(t){var e=t;t instanceof es.Sort||(e=es.newSort(t)),this.removeSortBy(e),this.sort.unshift(e)},this.removeSortBy=function(t){var e=t;t instanceof es.Sort||(e=es.newSort(t));for(var i=[],s=0;s<this.sort.length;s++){var r=this.sort[s];r.field===e.field&&i.push(s)}i=i.sort().reverse();for(var s=0;s<i.length;s++)this.sort.splice(i[s],1)},this.getSortBy=function(){return this.sort},this.setSource=function(t,e){},this.addFacet=function(){},this.removeFacet=function(){},this.clearFacets=function(){},this.getAggregation=function(t){for(var e=t.name,i=0;i<this.aggs.length;i++){var s=this.aggs[i];if(s.name===e)return s}},this.addAggregation=function(t,e){if(e)this.removeAggregation(t.name);else for(var i=0;i<this.aggs.length;i++)if(this.aggs[i].name===t.name)return;this.aggs.push(t)},this.removeAggregation=function(t){for(var e=[],i=0;i<this.aggs.length;i++)this.aggs[i].name===t&&e.push(i);e=e.sort().reverse();for(var i=0;i<e.length;i++)this.aggs.splice(e[i],1)},this.clearAggregations=function(){this.aggs=[]},this.listAggregations=function(){return this.aggs},this.addMust=function(t){var e=this.listMust(t);0===e.length&&this.must.push(t)},this.listMust=function(t){return this.listFilters({boolType:"must",template:t})},this.removeMust=function(t){for(var e=[],i=0;i<this.must.length;i++){var s=this.must[i];s.matches(t)&&e.push(i)}e=e.sort().reverse();for(var i=0;i<e.length;i++)this.must.splice(e[i],1)},this.clearMust=function(){},this.addShould=function(){},this.listShould=function(){},this.removeShould=function(){},this.clearShould=function(){},this.addMustNot=function(){},this.listMustNot=function(){},this.removeMustNot=function(){},this.removeMustNot=function(){},this.hasFilters=function(){return this.must.length>0||this.should.length>0||this.mustNot.length>0},this.listFilters=function(t){var e=t.boolType||"must",i=t.template||!1,s=[];if("must"===e?s=this.must:"should"===e?s=this.should:"must_not"===e&&(s=this.mustNot),!i)return s;for(var r=[],n=0;n<s.length;n++){var a=s[n];a.matches(i)&&r.push(a)}return r},this.merge=function(t){if(this.filtered=t.filtered,t.size&&(this.size=t.size),t.from&&(this.from=t.from),t.fields&&t.fields.length>0)for(var e=0;e<t.fields.length;e++)this.addField(t.fields[e]);for(var i=t.listAggregations(),e=0;e<i.length;e++)this.addAggregation(i[e],!0);for(var s=t.listMust(),e=0;e<s.length;e++)this.addMust(s[e]);t.getQueryString()&&this.setQueryString(t.getQueryString());var r=t.getSortBy();if(r&&r.length>0){r.reverse();for(var e=0;e<r.length;e++)this.prependSortBy(r[e])}},this.objectify=function(t){t||(t={});var e=void 0===t.include_query_string?!0:t.include_query_string,i=void 0===t.include_filters?!0:t.include_filters,s=void 0===t.include_paging?!0:t.include_paging,r=void 0===t.include_sort?!0:t.include_sort,n=void 0===t.include_fields?!0:t.include_fields,a=void 0===t.include_aggregations?!0:t.include_aggregations,h=(void 0===t.include_facets?!0:t.include_facets,{}),o={},g={};if(this.queryString&&e&&$.extend(o,this.queryString.objectify()),i&&this.must.length>0){for(var u=[],l=0;l<this.must.length;l++){var f=this.must[l];u.push(f.objectify())}g.must=u}if(this.filtered&&this.hasFilters()?(0==Object.keys(o).length&&(o.match_all={}),h.query={filtered:{filter:{bool:g},query:o}}):(this.hasFilters()&&(o.bool=g),0==Object.keys(o).length&&(o.match_all={}),h.query=o),s&&(void 0!==this.size&&this.size!==!1&&(h.size=this.size),this.from&&(h.from=this.from)),this.sort.length>0&&r){h.sort=[];for(var l=0;l<this.sort.length;l++)h.sort.push(this.sort[l].objectify())}if(this.fields.length>0&&n&&(h.fields=this.fields),this.aggs.length>0&&a){h.aggs={};for(var l=0;l<this.aggs.length;l++){var c=this.aggs[l];$.extend(h.aggs,c.objectify())}}return h},this.parse=function(t){function e(t,e){if(t.must)for(var i=0;i<t.must.length;i++){var s=Object.keys(t.must[i])[0],r=es.filterFactory(s,{raw:t.must[i]});r&&e.addMust(r)}}function i(t,e){for(var i=Object.keys(t),s=0;s<i.length;s++){var r=i[s],n=es.filterFactory(r,{raw:t[r]});n&&"query_string"===r&&e.setQueryString(n)}}if(t.query)if(t.query.filtered){this.filtered=!0;var s=t.query.filtered.filter.bool;s&&e(s,this);var r=t.query.filtered.query;i(r,this)}else{var r=t.query;i(r,this)}if(t.size&&(this.size=t.size),t.from&&(this.from=t.from),t.fields&&(this.fields=t.fields),t.sort)for(var n=0;n<t.sort.length;n++){var a=t.sort[n];this.addSortBy(es.newSort({raw:a}))}if(t.aggs||t.aggregations)for(var h=t.aggs?t.aggs:t.aggregations,o=Object.keys(h),n=0;n<o.length;n++){var g=o[n],u=h[g],l=Object.keys(u)[0],f={};f[g]=u;var c=es.aggregationFactory(l,{raw:f});c&&this.addAggregation(c)}},t.queryString&&this.setQueryString(t.queryString),t.sort&&this.setSortBy(t.sort),t.raw&&this.parse(t.raw)},newQueryString:function(t){return t||(t={}),new es.QueryString(t)},QueryString:function(t){this.queryString=t.queryString||!1,this.defaultField=t.defaultField||!1,this.defaultOperator=t.defaultOperator||"OR",this.fuzzify=t.fuzzify||!1,this.escapeSet=t.escapeSet||es.specialCharsSubSet,this.pairs=t.pairs||es.characterPairs,this.unEscapeSet=t.unEscapeSet||es.specialChars,this.objectify=function(){var t=this._escape(this._fuzzify(this.queryString)),e={query_string:{query:t}};return this.defaultOperator&&(e.query_string.default_operator=this.defaultOperator),this.defaultField&&(e.query_string.default_field=this.defaultField),e},this.parse=function(t){t.query_string&&(t=t.query_string),this.queryString=this._unescape(t.query),t.default_operator&&(this.defaultOperator=t.default_operator),t.default_field&&(this.defaultField=t.default_field)},this._fuzzify=function(t){if(!this.fuzzify||"*"!==this.fuzzify&&"~"!==this.fuzzify)return t;if(-1!==t.indexOf("*")||-1!==t.indexOf("~")||-1!==t.indexOf(":"))return t;for(var e="",i=t.split(" "),s=0;s<i.length;s++){var r=i[s];r.length>0&&(r+=this.fuzzify,"*"==this.fuzzify?r="*"+r:!1,e+=r+" ")}return e},this._escapeRegExp=function(t){return t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},this._replaceAll=function(t,e,i){return t.replace(new RegExp(this._escapeRegExp(e),"g"),i)},this._unReplaceAll=function(t,e){return t.replace(new RegExp("\\\\("+this._escapeRegExp(e)+")","g"),"$1")},this._paired=function(t,e){var i=t.match(new RegExp(this._escapeRegExp(e),"g"))||[];return i.length%2===0},this._escape=function(t){for(var e=this.escapeSet.slice(0),i=0;i<this.pairs.length;i++){var s=this.pairs[i];this._paired(t,s)||e.push(s)}for(var i=0;i<e.length;i++){var s=e[i];t=this._replaceAll(t,s,"\\"+s)}return t},this._unescape=function(t){for(var e=0;e<this.unEscapeSet.length;e++){var i=this.unEscapeSet[e];t=this._unReplaceAll(t,i)}return t},t.raw&&this.parse(t.raw)},newSort:function(t){return t||(t={}),new es.Sort(t)},Sort:function(t){this.field=t.field||"_score",this.order=t.order||"desc",this.objectify=function(){var t={};return t[this.field]={order:this.order},t},this.parse=function(t){this.field=Object.keys(t)[0],t[this.field].order&&(this.order=t[this.field].order)},t.raw&&this.parse(t.raw)},newAggregation:function(t){return t||(t={}),new es.Aggregation(t)},Aggregation:function(t){this.name=t.name,this.aggs=t.aggs||[],this.addAggregation=function(t){for(var e=0;e<this.aggs.length;e++)if(this.aggs[e].name===t.name)return;this.aggs.push(t)},this.removeAggregation=function(){},this.clearAggregations=function(){},this._make_aggregation=function(t,e){var i={};if(i[this.name]={},i[this.name][t]=e,this.aggs.length>0){i[this.name].aggs={};for(var s=0;s<this.aggs.length;s++)$.extend(i[this.name].aggs,this.aggs[s].objectify())}return i},this._parse_wrapper=function(t,e){this.name=Object.keys(t)[0];var i=t[this.name][e],s=t[this.name].aggs?t[this.name].aggs:t[this.name].aggregations;if(s)for(var r=Object.keys(s),n=0;n<r.length;n++){var a=r[n],h=s[r[n]],o=Object.keys(h)[0],g={};g[a]=h;var u=es.aggregationFactory(o,{raw:g});u&&this.addAggregation(u)}return i}},newTermsAggregation:function(t){return t||(t={}),es.TermsAggregation.prototype=es.newAggregation(t),new es.TermsAggregation(t)},TermsAggregation:function(t){this.field=t.field||!1,this.size=t.size||10,this.orderBy="_count",t.orderBy&&(this.orderBy=t.orderBy,"_"!==this.orderBy[0]&&(this.orderBy="_"+this.orderBy)),this.orderDir=t.orderDir||"desc",this.setOrdering=function(t,e){this.orderBy=t,"_"!==this.orderBy[0]&&(this.orderBy="_"+this.orderBy),this.orderDir=e},this.objectify=function(){var t={field:this.field,size:this.size,order:{}};return t.order[this.orderBy]=this.orderDir,this._make_aggregation("terms",t)},this.parse=function(t){var e=this._parse_wrapper(t,"terms");this.field=e.field,e.size&&(this.size=e.size),e.order&&(this.orderBy=Object.keys(e.order)[0],this.orderDir=e.order[this.orderBy])},t.raw&&this.parse(t.raw)},newRangeAggregation:function(t){return t||(t={}),es.RangeAggregation.prototype=es.newAggregation(t),new es.RangeAggregation(t)},RangeAggregation:function(t){this.field=t.field||!1,this.ranges=t.ranges||[],this.objectify=function(){var t={field:this.field,ranges:this.ranges};return this._make_aggregation("range",t)},this.parse=function(t){var e=this._parse_wrapper(t,"range");this.field=e.field,this.ranges=e.ranges},t.raw&&this.parse(t.raw)},newGeoDistanceAggregation:function(t){return t||(t={}),es.GeoDistanceAggregation.prototype=es.newAggregation(t),new es.GeoDistanceAggregation(t)},GeoDistanceAggregation:function(t){this.field=t.field||!1,this.lat=t.lat||!1,this.lon=t.lon||!1,this.unit=t.unit||"m",this.distance_type=t.distance_type||"sloppy_arc",this.ranges=t.ranges||[],this.objectify=function(){var t={field:this.field,origin:{lat:this.lat,lon:this.lon},unit:this.unit,distance_type:this.distance_type,ranges:this.ranges};return this._make_aggregation("geo_distance",t)},this.parse=function(t){var e=this._parse_wrapper(t,"range");this.field=e.field;var i=e.origin;i.lat&&(this.lat=i.lat),i.lon&&(this.lon=i.lon),e.unit&&(this.unit=e.unit),e.distance_type&&(this.distance_type=e.distance_type),this.ranges=e.ranges},t.raw&&this.parse(t.raw)},newStatsAggregation:function(t){return t||(t={}),es.StatsAggregation.prototype=es.newAggregation(t),new es.StatsAggregation(t)},StatsAggregation:function(t){this.field=t.field||!1,this.objectify=function(){var t={field:this.field};return this._make_aggregation("stats",t)},this.parse=function(t){},t.raw&&this.parse(t.raw)},newDateHistogramAggregation:function(t){return t||(t={}),es.DateHistogramAggregation.prototype=es.newAggregation(t),new es.DateHistogramAggregation(t)},DateHistogramAggregation:function(t){this.field=t.field||!1,this.interval=t.interval||"month",this.format=t.format||!1,this.objectify=function(){var t={field:this.field,interval:this.interval};return this.format&&(t.format=this.format),this._make_aggregation("date_histogram",t)},this.parse=function(t){var e=this._parse_wrapper(t,"date_histogram");this.field=e.field,e.interval&&(this.interval=e.interval),e.format&&(this.format=e.format)},t.raw&&this.parse(t.raw)},newFilter:function(t){return t||(t={}),new es.Filter(t)},Filter:function(t){this.field=t.field,this.type_name=t.type_name,this.matches=function(t){return t.type_name!==this.type_name?!1:t.field&&t.field!==this.field?!1:!0},this.objectify=function(){},this.parse=function(){}},newTermFilter:function(t){return t||(t={}),t.type_name="term",es.TermFilter.prototype=es.newFilter(t),new es.TermFilter(t)},TermFilter:function(t){this.value=t.value||!1,this.matches=function(t){var e=Object.getPrototypeOf(this).matches.call(this,t);return e?t.value&&t.value!==this.value?!1:!0:!1},this.objectify=function(){var t={term:{}};return t.term[this.field]=this.value,t},this.parse=function(t){t.term&&(t=t.term),this.field=Object.keys(t)[0],this.value=t[this.field]},t.raw&&this.parse(t.raw)},newTermsFilter:function(t){return t||(t={}),t.type_name="terms",es.TermsFilter.prototype=es.newFilter(t),new es.TermsFilter(t)},TermsFilter:function(t){this.values=t.values||!1,this.execution=t.execution||!1,this.matches=function(t){var e=Object.getPrototypeOf(this).matches.call(this,t);if(!e)return!1;if(t.values){if(t.values.length!==this.values.length)return!1;for(var i=0;i<t.values.length;i++)if(-1===$.inArray(t.values[i],this.values))return!1}return!0},this.objectify=function(){var t=this.values||[],e={terms:{}};return e.terms[this.field]=t,this.execution&&(e.terms.execution=this.execution),e},this.parse=function(t){t.terms&&(t=t.terms),this.field=Object.keys(t)[0],this.values=t[this.field],t.execution&&(this.execution=t.execution)},this.add_term=function(t){this.values||(this.values=[]),-1===$.inArray(t,this.values)&&this.values.push(t)},this.has_term=function(t){return this.values?$.inArray(t,this.values)>=0:!1},this.remove_term=function(t){if(this.values){var e=$.inArray(t,this.values);e>=0&&this.values.splice(e,1)}},this.has_terms=function(){return this.values!==!1&&this.values.length>0},this.term_count=function(){return this.values===!1?0:this.values.length},t.raw&&this.parse(t.raw)},newRangeFilter:function(t){return t||(t={}),t.type_name="range",es.RangeFilter.prototype=es.newFilter(t),new es.RangeFilter(t)},RangeFilter:function(t){this.lt=t.lt||!1,this.gte=t.gte||!1,this.matches=function(t){var e=Object.getPrototypeOf(this).matches.call(this,t);return e?t.lt&&t.lt!==this.lt?!1:t.gte&&t.gte!==this.gte?!1:!0:!1},this.objectify=function(){var t={range:{}};return t.range[this.field]={},this.lt&&(t.range[this.field].lt=this.lt),this.gte&&(t.range[this.field].gte=this.gte),t},this.parse=function(t){t.range&&(t=t.range),this.field=Object.keys(t)[0],t[this.field].lt&&(this.lt=t[this.field].lt),t[this.field].gte&&(this.gte=t[this.field].gte)},t.raw&&this.parse(t.raw)},newGeoDistanceRangeFilter:function(t){return t||(t={}),t.type_name="geo_distance_range",es.GeoDistanceRangeFilter.prototype=es.newFilter(t),new es.GeoDistanceRangeFilter(t)},GeoDistanceRangeFilter:function(t){this.lt=t.lt||!1,this.gte=t.gte||!1,this.lat=t.lat||!1,this.lon=t.lon||!1,this.unit=t.unit||"m",this.objectify=function(){var t={geo_distance_range:{}};return t.geo_distance_range[this.field]={lat:this.lat,lon:this.lon},this.lt&&(t.geo_distance_range.lt=this.lt+this.unit),this.gte&&(t.geo_distance_range.gte=this.gte+this.unit),t},this.parse=function(t){function e(t,e){return-1!==t.indexOf(e,t.length-e.length)}function i(t){for(var i=!1,s=0;s<es.distanceUnits.length;s++){var r=es.distanceUnits[s];e(t,r)&&(t=t.substring(0,t.length-r.length),i=t.substring(t.length-r.length))}return[t,i]}t.geo_distance_range&&(t=t.geo_distance_range),this.field=Object.keys(t)[0],this.lat=t[this.field].lat,this.lon=t[this.field].lon;var s=t[this.field].lt,r=t[this.field].gte;if(s){s=s.trim();var n=i(s);this.lt=n[0],this.unit=n[1]}if(r){r=r.trim();var n=i(r);this.gte=n[0],this.unit=n[1]}},t.raw&&this.parse(t.raw)},newResult:function(t){return t||(t={}),new es.Result(t)},Result:function(t){this.data=t.raw,this.buckets=function(t){return this.data.aggregations[t].buckets},this.aggregation=function(t){return this.data.aggregations[t]},this.results=function(){var t=[];if(this.data.hits&&this.data.hits.hits)for(var e=0;e<this.data.hits.hits.length;e++){var i=this.data.hits.hits[e];"_source"in i?t.push(i._source):"fields"in i&&t.push(i.fields)}return t},this.total=function(){return this.data.hits&&this.data.hits.total?parseInt(this.data.hits.total):!1}},doQuery:function(t){var e=t.success,i=t.complete,s=t.search_url,r=t.queryobj,n=t.datatype,a=JSON.stringify(r);$.ajax({type:"get",url:s,data:{source:a},dataType:n,success:es.querySuccess(e),complete:i})},querySuccess:function(t){return function(e){var i=es.newResult({raw:e});t(i)}}};
!function(n){n.fn.bindWithDelay=function(i,t,u,e,o){function l(){var i=n.extend(!0,{},arguments[0]),t=function(){r=null,u.apply(a,[i])};o||clearTimeout(r),o&&r||(r=setTimeout(t,e))}var r=null,a=this;return n.isFunction(t)&&(o=e,e=u,u=t,t=void 0),this.bind(i,t,l)}}(jQuery);
var edges={newEdge:function(e){return e||(e={}),new edges.Edge(e)},Edge:function(e){this.selector=e.selector||"body",this.search_url=e.search_url,this.datatype=e.datatype||"jsonp",this.baseQuery=e.baseQuery||!1,this.openingQuery=e.openingQuery||es.newQuery(),this.initialSearch=e.initialSearch||!0,this.manageUrl=e.manageUrl||!1,this.urlQuerySource=e.urlQuerySource||"source",this.template=e.template||!1,this.components=e.components||[],this.renderPacks=e.renderPacks||[edges.bs3,edges.nvd3,edges.highcharts,edges.google,edges.d3],this.urlQuery=!1,this.urlParams={},this.shortUrl=!1,this.currentQuery=!1,this.result=!1,this.searching=!1,this.context=!1,this.startup=function(){if(this.context=$(this.selector),this.context.trigger("edges:pre-init"),this.manageUrl){var e=this.getUrlParams();this.urlQuerySource in e&&(this.urlQuery=es.newQuery({raw:e[this.urlQuerySource]}),delete e[this.urlQuerySource]),this.urlParams=e}this.template&&this.template.draw(this);for(var t=0;t<this.components.length;t++){var r=this.components[t];r.init(this)}for(var t=0;t<this.components.length;t++){var r=this.components[t];r.draw(this)}var n=this.openingQuery;this.urlQuery&&(n=this.urlQuery,this.urlQuery=!1);for(var t=0;t<this.components.length;t++){var r=this.components[t];r.contrib(n)}this.pushQuery(n),this.context.trigger("edges:post-init"),this.doQuery()},this.synchronise=function(){for(var e=0;e<this.components.length;e++){var t=this.components[e];t.synchronise()}},this.reset=function(){this.context.trigger("edges:pre-reset");for(var e=this.cloneOpeningQuery(),t=0;t<this.components.length;t++){var r=this.components[t];r.contrib(e)}this.pushQuery(e),this.context.trigger("edges:post-reset"),this.doQuery()},this.cloneQuery=function(){return $.extend(!0,{},this.currentQuery)},this.pushQuery=function(e){this.baseQuery&&e.merge(this.baseQuery),this.currentQuery=e},this.cloneBaseQuery=function(){return this.baseQuery?$.extend(!0,{},this.baseQuery):es.newQuery()},this.cloneOpeningQuery=function(){return this.openingQuery?$.extend(!0,{},this.openingQuery):es.newQuery()},this.doQuery=function(){this.searching||(this.searching=!0,this.shortUrl=!1,this.context.trigger("edges:pre-query"),this.manageUrl&&this.updateUrl(),es.doQuery({search_url:this.search_url,queryobj:this.currentQuery.objectify(),datatype:this.datatype,success:edges.objClosure(this,"querySuccess",["result"]),error:edges.objClosure(this,"queryFail"),complete:edges.objClosure(this,"queryComplete")}))},this.queryFail=function(e){this.context.trigger("edges:query-fail")},this.querySuccess=function(e){this.result=e.result,this.context.trigger("edges:query-success"),this.synchronise()},this.queryComplete=function(){this.context.trigger("edges:pre-render");for(var e=0;e<this.components.length;e++){var t=this.components[e];t.draw()}this.context.trigger("edges:post-render"),this.searching=!1},this.category=function(e){for(var t=[],r=0;r<this.components.length;r++){var n=this.components[r];n.category===e&&t.push(n)}return t},this.getRenderPackObject=function(e,t){for(var r=0;r<this.renderPacks.length;r++){var n=this.renderPacks[r];if(n&&n.hasOwnProperty(e))return n[e](t)}},this.jq=function(e){return $(e,this.context)},this.getUrlParams=function(){var e={},t=window.location.href,r=!1;t.indexOf("#")>-1&&(r=t.slice(t.indexOf("#")),t=t.substring(0,t.indexOf("#")));for(var n=t.slice(t.indexOf("?")+1).split("&"),s=0;s<n.length;s++){var i=n[s].split("=");if(2===i.length){var o=decodeURIComponent(i[1]);("["==o[0]||"{"==o[0])&&(o=o.replace(/^"/,"").replace(/"$/,""),o=JSON.parse(o)),e[i[0]]=o}}return r&&(e["#"]=r),e},this.urlQueryArg=function(e){e||(e={include_query_string:!0,include_filters:!0,include_paging:!0,include_sort:!0,include_fields:!1,include_aggregations:!1,include_facets:!1});var t=JSON.stringify(this.currentQuery.objectify(e)),r={};return r[this.urlQuerySource]=encodeURIComponent(t),r},this.fullQueryArgs=function(){var e=$.extend(!0,{},this.urlParams);return $.extend(e,this.urlQueryArg()),e},this.fullUrlQueryString=function(){return this._makeUrlQuery(this.fullQueryArgs())},this._makeUrlQuery=function(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;n++){var s=t[n],i=e[s];r.push(s+"="+i)}return r.join("&")},this.fullUrl=function(){var e=this.fullQueryArgs(),t="";e["#"]&&(t="#"+e["#"],delete e["#"]);var r=window.location.toString(),n=r.split("?"),s=n[0]+"?"+this._makeUrlQuery(e)+t;return s},this.updateUrl=function(){if("pushState"in window.history){var e="?"+this.fullUrlQueryString();window.history.pushState("","",e)}},this.startup()},newRenderer:function(e){return e||(e={}),new edges.Renderer(e)},Renderer:function(e){this.component=e.component||!1,this.init=function(e){this.component=e},this.draw=function(e){}},newComponent:function(e){return e||(e={}),new edges.Component(e)},Component:function(e){this.id=e.id,this.renderer=e.renderer,this.category=e.category||"none",this.defaultRenderer=e.defaultRenderer||"newRenderer",this.init=function(e){this.edge=e,this.context=this.edge.jq("#"+this.id),this.renderer||(this.renderer=this.edge.getRenderPackObject(this.defaultRenderer)),this.renderer&&this.renderer.init(this)},this.draw=function(){this.renderer&&this.renderer.draw()},this.contrib=function(e){},this.synchronise=function(){},this.jq=function(e){return this.edge.jq(e)}},newSelector:function(e){return e||(e={}),edges.Selector.prototype=edges.newComponent(e),new edges.Selector(e)},Selector:function(e){this.field=e.field,this.display=e.display||this.field,this.active=e.active||!0,this.disabled=e.disabled||!1,this.category=e.category||"selector"},newTemplate:function(e){return e||(e={}),new edges.Template(e)},Template:function(e){this.draw=function(e){}},objClosure:function(e,t,r){return function(){if(r){for(var n={},s=0;s<r.length;s++)arguments.length>s&&(n[r[s]]=arguments[s]);e[t](n)}else{var i=Array.prototype.slice;e[t].apply(e,i.apply(arguments))}}},eventClosure:function(e,t,r){return function(n){(!r||r(n))&&(n.preventDefault(),e[t](this))}},css_classes:function(e,t,r){var n=e+"-"+t;return r&&(n+=" "+n+"-"+r.component.id),n},css_class_selector:function(e,t,r){var n="."+e+"-"+t;return r&&(n+=n+"-"+r.component.id),n},css_id:function(e,t,r){var n=e+"-"+t;return r&&(n+="-"+r.component.id),n},css_id_selector:function(e,t,r){return"#"+edges.css_id(e,t,r)},on:function(e,t,r,n,s,i){t=t+"."+r.component.id;var o=edges.eventClosure(r,n,i);s?r.component.jq(e).bindWithDelay(t,o,s):r.component.jq(e).on(t,o)},escapeHtml:function(e){return"function"!=typeof e.replace?e:e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},objVal:function(e,t,r){void 0===r&&(r=!1);for(var n=e.split("."),s=t,i=0;i<n.length;i++){var o=n[i];if(!(o in s))return r;s=s[o]}return s},getParam:function(e,t){return void 0!==e?e:t}};
$.extend(edges,{newChart:function(e){return e||(e={}),edges.Chart.prototype=edges.newComponent(e),new edges.Chart(e)},Chart:function(e){this.category=e.category||"chart",this.display=e.display||"",this.dataSeries=e.dataSeries||!1,this.dataFunction=e.dataFunction||!1,this.dataFunctionClosure=e.dataFunctionClosure||!1,this.aggregations=e.aggregations||[],this.dfArgs=e.dfArgs||{useAggregations:[],seriesKeys:{}},this.defaultRenderer=e.defaultRenderer||"newMultibarRenderer",this.init=function(e){edges.newComponent().init.call(this,e);for(var t=0;t<this.aggregations.length;t++){var r=this.aggregations[t];-1===$.inArray(r.name,this.dfArgs.useAggregations)&&this.dfArgs.useAggregations.push(r.name)}this.aggregations.length>0&&this.dataFunctionClosure&&(this.dataFunction=this.dataFunctionClosure(this.dfArgs))},this.contrib=function(e){for(var t=0;t<this.aggregations.length;t++)e.addAggregation(this.aggregations[t])},this.synchronise=function(){this.dataFunction&&(this.dataSeries=this.dataFunction(this))}},ChartDataFunctions:{terms:function(e){var t=e.useAggregations||[],r=e.seriesKeys||{};return function(e){var a=[];if(!e.edge.result)return a;for(var n=0;n<t.length;n++){var s=t[n],i=e.edge.result.data.aggregations[s].buckets,u={};u.key=r[s],u.values=[];for(var l=0;l<i.length;l++){var o=i[l].doc_count,d=i[l].key;u.values.push({label:d,value:o})}a.push(u)}return a}},termsStats:function(e){var t=e.useAggregations||[],r=e.seriesKeys||{},a=e.seriesFor||[];return function(e){var n=[];if(!e.edge.result)return n;for(var s=0;s<t.length;s++)for(var i=t[s],u=i.split(" "),l=0;l<a.length;l++){var o=a[l],d={};d.key=r[i+" "+o],d.values=[];for(var g=e.edge.result.data.aggregations[u[0]].buckets,h=0;h<g.length;h++){var f=g[h][u[1]],v=g[h].key,c=f[o];d.values.push({label:v,value:c})}n.push(d)}return n}},recordsXY:function(e){var t=e.x,r=void 0===e.x_default?0:e.x_default,a=e.y,n=void 0===e.y_default?0:e.y_default,s=e.key;return function(e){var i=[];if(!e.edge.result)return i;var u={};u.key=s,u.values=[];for(var l=e.edge.result.results(),o=0;o<l.length;o++){var d=l[o],g=edges.objVal(t,d,r),h=edges.objVal(a,d,n);u.values.push({label:g,value:h})}return i.push(u),i}},cumulativeXY:function(e){var t=e.x,r=void 0===e.x_default?0:e.x_default,a=e.y,n=void 0===e.y_default?0:e.y_default,s=e.key,i=e.accumulate||"y";return function(e){var u=[];if(!e.edge.result)return u;var l={};l.key=s,l.values=[];for(var o=0,d=e.edge.result.results(),g=0;g<d.length;g++){var h=d[g],f=edges.objVal(t,h,r),v=edges.objVal(a,h,n);"x"===i?(o+=f,l.values.push({label:o,value:v})):"y"===i&&(o+=v,l.values.push({label:f,value:o}))}return u.push(l),u}},totalledList:function(e){var t=e.listPath||"",r=e.seriesKey||"",a=e.keyField||!1,n=e.valueField||!1;return function(e){var s=[];if(!e.edge.result)return s;var i={};i.key=r,i.values=[];for(var u={},l=e.edge.result.results(),o=0;o<l.length;o++)for(var d=l[o],g=edges.objVal(t,d,[]),h=0;h<g.length;h++){var f=g[h],v=edges.objVal(a,f,!1),c=edges.objVal(n,f,0);v in u?u[v]+=c:u[v]=c}for(v in u){var y=u[v];i.values.push({label:v,value:y})}return s.push(i),s}}},newPieChart:function(e){return e||(e={}),edges.PieChart.prototype=edges.newChart(e),new edges.PieChart(e)},PieChart:function(e){this.defaultRenderer=e.defaultRenderer||"newPieChartRenderer"},newHorizontalMultibar:function(e){return e||(e={}),edges.HorizontalMultibar.prototype=edges.newChart(e),new edges.HorizontalMultibar(e)},HorizontalMultibar:function(e){this.defaultRenderer=e.defaultRenderer||"newHorizontalMultibarRenderer"},newMultibar:function(e){return e||(e={}),edges.Multibar.prototype=edges.newChart(e),new edges.Multibar(e)},Multibar:function(e){this.defaultRenderer=e.defaultRenderer||"newMultibarRenderer"},newSimpleLineChart:function(e){return e||(e={}),edges.SimpleLineChart.prototype=edges.newChart(e),new edges.SimpleLineChart(e)},SimpleLineChart:function(e){this.xAxisLabel=e.xAxisLabel||"",this.yAxisLabel=e.yAxisLabel||"",this.defaultRenderer=e.defaultRenderer||"newSimpleLineChartRenderer"}});
$.extend(edges,{newMapView:function(t){return t||(t={}),edges.MapView.prototype=edges.newComponent(t),new edges.MapView(t)},MapView:function(t){this.geoPoint=t.geoPoint||"location",this.structure=t.structure||"properties",this.calculateCentre=t.calculateCentre||edges.MapCentreFunctions.pickFirst,this.defaultRenderer=t.defaultRenderer||"newMapViewRenderer",this.locations=[],this.centre={lat:17,lon:0},this.synchronise=function(){if(this.locations=[],this.centre={lat:17,lon:0},this.edge.result)for(var t=this.edge.result.results(),e=0;e<t.length;e++){var n=t[e],i=this._getGeoPoint(n);if(i){var o=this._getLatLon(i);o.obj=n,this.locations.push(o)}}this.locations.length>0&&(this.centre=this.calculateCentre(this.locations))},this._getLatLon=function(t){var e={};return"properties"===this.structure&&(e.lat=parseFloat(t.lat),e.lon=parseFloat(t.lon)),e},this._getGeoPoint=function(t){for(var e=this.geoPoint.split("."),n=t,i=0;i<e.length;i++){var o=e[i],s=i<e.length-1?{}:!1;n=void 0!==n[o]?n[o]:s}return n}},MapCentreFunctions:{pickFirst:function(t){return{lat:t[0].lat,lon:t[0].lon}}}});
$.extend(edges,{newNumericRangeEntry:function(e){return e||(e={}),edges.NumericRangeEntry.prototype=edges.newSelector(e),new edges.NumericRangeEntry(e)},NumericRangeEntry:function(e){this.lower=void 0===e.lower?!1:e.lower,this.upper=void 0===e.upper?!1:e.upper,this.increment=e.increment||1,this.defaultRenderer=e.defaultRenderer||"newNumericRangeEntryRenderer",this.from=!1,this.to=!1,this.init=function(e){if(edges.newSelector().init.call(this,e),!this.lower||!this.upper){var t=this.edge.cloneBaseQuery();t.clearAggregations(),t.size=0,t.addAggregation(es.newStatsAggregation({name:this.id,field:this.field})),es.doQuery({search_url:this.edge.search_url,queryobj:t.objectify(),datatype:this.edge.datatype,success:edges.objClosure(this,"querySuccess",["result"]),error:edges.objClosure(this,"queryFail")})}},this.synchronise=function(){if(this.from=this.lower,this.to=this.upper,this.edge.currentQuery)for(var e=this.edge.currentQuery.listMust(es.newRangeFilter({field:this.field})),t=0;t<e.length;t++)this.to=e[t].lt,this.from=e[t].gte},this.querySuccess=function(e){var t=e.result,i=t.aggregation(this.id);this.lower===!1&&(this.lower=i.min),this.upper===!1&&(this.upper=i.max),this.draw()},this.queryFail=function(e){this.lower===!1&&(this.lower=0),this.upper===!1&&(this.upper=0)},this.selectRange=function(e,t){var i=this.edge.cloneQuery();i.removeMust(es.newRangeFilter({field:this.field})),(e!==this.lower||t!==this.upper)&&i.addMust(es.newRangeFilter({field:this.field,gte:e,lt:t})),i.from=0,this.edge.pushQuery(i),this.edge.doQuery()}},newMultiDateRangeEntry:function(e){return e||(e={}),edges.MultiDateRangeEntry.prototype=edges.newComponent(e),new edges.MultiDateRangeEntry(e)},MultiDateRangeEntry:function(e){this.fields=e.fields||[],this.earliest=e.earliest||{},this.latest=e.latest||{},this.category=e.category||"selector",this.defaultEarliest=e.defaultEarliest||new Date(0),this.defaultLatest=e.defaultLatest||new Date,this.defaultRenderer=e.defaultRenderer||"newMultiDateRangeRenderer",this.currentField=!1,this.fromDate=!1,this.toDate=!1,this.touched=!1,this.dateOptions={},this.init=function(e){Object.getPrototypeOf(this).init.call(this,e),this.currentField=this.fields[0].field,this.lastField=!1,this.loadDates()},this.changeField=function(e){this.lastField=this.currentField,e!==this.currentField&&(this.touched=!0,this.currentField=e)},this.setFrom=function(e){e!==this.fromDate&&(this.touched=!0,this.fromDate=e)},this.setTo=function(e){e!==this.toDate&&(this.touched=!0,this.toDate=e)},this.triggerSearch=function(){if(this.touched){this.touched=!1;var e=this.edge.cloneQuery();if(e.removeMust(es.newRangeFilter({field:this.lastField})),!this.currentField||!this.toDate&&!this.fromDate)return;var t={field:this.currentField};this.toDate&&(t.lt=this.toDate),this.fromDate&&(t.gte=this.fromDate),e.addMust(es.newRangeFilter(t)),this.edge.pushQuery(e),this.edge.doQuery()}},this.loadDates=function(){for(var e=0;e<this.fields.length;e++){var t=this.fields[e].field,i=this.earliest[t],s=this.latest[t],r=this.defaultEarliest;i&&(r=i());var n=this.defaultLatest;s&&(n=s()),this.dateOptions[t]={earliest:r,latest:n}}},this.currentEarliest=function(){return this.currentField&&this.dateOptions[this.currentField]?this.dateOptions[this.currentField].earliest:void 0},this.currentLatest=function(){return this.currentField&&this.dateOptions[this.currentField]?this.dateOptions[this.currentField].latest:void 0}}});
$.extend(edges,{newFullSearchController:function(e){return e||(e={}),edges.FullSearchController.prototype=edges.newComponent(e),new edges.FullSearchController(e)},FullSearchController:function(e){this.fuzzify=e.fuzzify||!1,this.sortOptions=e.sortOptions||!1,this.fieldOptions=e.fieldOptions||!1,this.urlShortener=e.urlShortener||!1,this.defaultOperator=e.defaultOperator||"OR",this.defaultRenderer=e.defaultRenderer||"newFullSearchControllerRenderer",this.searchField=!1,this.searchString=!1,this.sortBy=!1,this.sortDir="desc",this.shortUrl=!1,this.synchronise=function(){if(this.searchString=!1,this.searchField=!1,this.sortBy=!1,this.sortDir="desc",this.edge.currentQuery){var e=this.edge.currentQuery.getQueryString();e&&(this.searchString=e.queryString,this.searchField=e.defaultField);var t=this.edge.currentQuery.getSortBy();t.length>0&&(this.sortBy=t[0].field,this.sortDir=t[0].order)}},this.changeSortDir=function(){var e="asc"===this.sortDir?"desc":"asc",t=this.sortBy?this.sortBy:"_score",s=this.edge.cloneQuery();s.setSortBy(es.newSort({field:t,order:e})),s.from=0,this.edge.pushQuery(s),this.edge.doQuery()},this.setSortBy=function(e){var t=this.edge.cloneQuery();e&&""!==e||(e="_score"),t.setSortBy(es.newSort({field:e,order:this.sortDir})),t.from=0,this.edge.pushQuery(t),this.edge.doQuery()},this.setSearchField=function(e){if(this.searchField=e,this.searchString&&""!==this.searchString){var t=this.edge.cloneQuery();t.setQueryString(es.newQueryString({queryString:this.searchString,defaultField:e,defaultOperator:this.defaultOperator,fuzzify:this.fuzzify})),t.from=0,this.edge.pushQuery(t),this.edge.doQuery()}},this.setSearchText=function(e){var t=this.edge.cloneQuery();if(""!==e){var s={queryString:e,defaultOperator:this.defaultOperator,fuzzify:this.fuzzify};this.searchField&&""!==this.searchField&&(s.defaultField=this.searchField),t.setQueryString(es.newQueryString(s))}else t.removeQueryString();t.from=0,this.edge.pushQuery(t),this.edge.doQuery()},this.clearSearch=function(){this.edge.reset()}},newSelectedFilters:function(e){return e||(e={}),edges.SelectedFilters.prototype=edges.newComponent(e),new edges.SelectedFilters(e)},SelectedFilters:function(e){this.fieldDisplays=e.fieldDisplays||{},this.valueMaps=e.valueMaps||{},this.valueFunctions=e.valueFunctions||{},this.rangeMaps=e.rangeMaps||{},this.formatUnknownRange=e.formatUnknownRange||!1,this.defaultRenderer=e.defaultRenderer||"newSelectedFiltersRenderer",this.mustFilters={},this.synchronise=function(){this.mustFilters={};for(var e=this.edge.currentQuery.listMust(),t=0;t<e.length;t++){var s=e[t];"term"===s.type_name?this._synchronise_term(s):"terms"===s.type_name?this._synchronise_terms(s):"range"===s.type_name?this._synchronise_range(s):"geo_distance_range"===s.type_name}},this.removeFilter=function(e,t,s,i){var r=this.edge.cloneQuery();if("term"===t){var n=es.newTermFilter({field:s,value:i});"must"===e&&r.removeMust(n)}else if("terms"===t){var n=es.newTermsFilter({field:s});if("must"===e)for(var h=r.listMust(n),a=0;a<h.length;a++)h[a].has_term(i)&&h[a].remove_term(i),h[a].has_terms()||r.removeMust(h[a])}else if("range"==t){var o={field:s};i.to&&(o.lt=i.to),i.from&&(o.gte=i.from);var n=es.newRangeFilter(o);"must"===e&&r.removeMust(n)}r.from=0,this.edge.pushQuery(r),this.edge.doQuery()},this._synchronise_term=function(e){var t=this.fieldDisplays[e.field]||e.field;e.field in this.mustFilters?this.mustFilters[e.field].values.push({val:e.value,display:this._translate(e.field,e.value)}):this.mustFilters[e.field]={filter:e.type_name,display:t,values:[{val:e.value,display:this._translate(e.field,e.value)}],rel:"AND"}},this._synchronise_terms=function(e){for(var t=this.fieldDisplays[e.field]||e.field,s=[],i=0;i<e.values.length;i++){var r=e.values[i],n=this._translate(e.field,r);s.push({val:r,display:n})}this.mustFilters[e.field]={filter:e.type_name,display:t,values:s,rel:"OR"}},this._synchronise_range=function(e){var t=this.fieldDisplays[e.field]||e.field,s=e.lt,i=e.gte,r=this._getRangeDef(e.field,i,s),n=[];r?n.push(r):n.push({to:s,from:i,display:this._formatUnknown(i,s)}),this.mustFilters[e.field]={filter:e.type_name,display:t,values:n}},this._translate=function(e,t){if(e in this.valueMaps){if(t in this.valueMaps[e])return this.valueMaps[e][t]}else if(e in this.valueFunctions)return this.valueFunctions[e](t);return t},this._getRangeDef=function(e,t,s){if(!this.rangeMaps[e])return!1;for(var i=0;i<this.rangeMaps[e].length;i++){var r=this.rangeMaps[e][i],n=!0,h=!0;if((t&&!r.from||!t&&r.from)&&(n=!1),(s&&!r.to||!s&&r.to)&&(h=!1),t&&r.from&&t!==r.from&&(n=!1),s&&r.to&&s!==r.to&&(h=!1),n&&h)return r}return!1},this._formatUnknown=function(e,t){if(this.formatUnknownRange)return this.formatUnknownRange(e,t);if((e||t)&&e===t)return e;var s="";return s+=e?e:"< ",t?s+=e?" - "+t:t:e?s+="+":s="unknown",s}},newPager:function(e){return e||(e={}),edges.Pager.prototype=edges.newComponent(e),new edges.Pager(e)},Pager:function(e){this.defaultRenderer=e.defaultRenderer||"newPagerRenderer",this.from=!1,this.to=!1,this.total=!1,this.page=!1,this.pageSize=!1,this.totalPages=!1,this.synchronise=function(){this.from=!1,this.to=!1,this.total=!1,this.page=!1,this.pageSize=!1,this.totalPages=!1,this.edge.currentQuery&&(this.from=parseInt(this.edge.currentQuery.getFrom())+1,this.pageSize=parseInt(this.edge.currentQuery.getSize())),this.edge.result&&(this.total=this.edge.result.total()),this.from!==!1&&this.total!==!1&&(this.to=this.from+this.pageSize-1,this.page=Math.ceil((this.from-1)/this.pageSize)+1,this.totalPages=Math.ceil(this.total/this.pageSize))},this.setFrom=function(e){var t=this.edge.cloneQuery();e-=1,0>e&&(e=0),t.from=e,this.edge.pushQuery(t),this.edge.doQuery()},this.setSize=function(e){var t=this.edge.cloneQuery();t.size=e,this.edge.pushQuery(t),this.edge.doQuery()},this.decrementPage=function(){var e=this.from-this.pageSize;this.setFrom(e)},this.incrementPage=function(){var e=this.from+this.pageSize;this.setFrom(e)}},newSearchingNotification:function(e){return e||(e={}),edges.SearchingNotification.prototype=edges.newComponent(e),new edges.SearchingNotification(e)},SearchingNotification:function(e){this.defaultRenderer=e.defaultRenderer||"newSearchingNotificationRenderer",this.searching=!1,this.init=function(e){Object.getPrototypeOf(this).init.call(this,e),e.context.on("edges:pre-query",edges.eventClosure(this,"searchingBegan")),e.context.on("edges:query-fail",edges.eventClosure(this,"searchingFinished")),e.context.on("edges:query-success",edges.eventClosure(this,"searchingFinished"))},this.draw=function(){},this.searchingBegan=function(){this.searching=!0,this.renderer.draw()},this.searchingFinished=function(){this.searching=!1,this.renderer.draw()}},newResultsDisplay:function(e){return e||(e={}),edges.ResultsDisplay.prototype=edges.newComponent(e),new edges.ResultsDisplay(e)},ResultsDisplay:function(e){this.category=e.category||"results",this.defaultRenderer=e.defaultRenderer||"newResultsDisplayRenderer",this.results=!1,this.synchronise=function(){this.results=[],this.edge.result&&(this.results=this.edge.result.results())}}});
$.extend(edges,{newRefiningANDTermSelector:function(e){return e||(e={}),edges.RefiningANDTermSelector.prototype=edges.newSelector(e),new edges.RefiningANDTermSelector(e)},RefiningANDTermSelector:function(e){this.size=e.size||10,this.orderBy=e.orderBy||"count",this.orderDir=e.orderDir||"desc",this.deactivateThreshold=e.deactivateThreshold||!1,this.ignoreEmptyString=e.ignoreEmptyString||!0,this.excludePreDefinedFilters=e.excludePreDefinedFilters||!0,this.valueMap=e.valueMap||!1,this.valueFunction=e.valueFunction||!1,this.inflation=e.inflation||100,this.defaultRenderer=e.defaultRenderer||"newRefiningANDTermSelectorRenderer",this.filters=[],this.values=[],this.contrib=function(e){var t={name:this.id,field:this.field,orderBy:this.orderBy,orderDir:this.orderDir};this.size&&(t.size=this.size),e.addAggregation(es.newTermsAggregation(t))},this.synchronise=function(){if(this.values=[],this.filters=[],this.edge.result){var e=this.edge.result.buckets(this.id);e.length<this.deactivateThreshold?this.active=!1:this.active=!0;var t=[];this.excludePreDefinedFilters&&this.edge.baseQuery&&(t=this.edge.baseQuery.listMust(es.TermFilter({field:this.field})));for(var i=0,s=0;s<e.length;s++){var r=e[s];if(!this.ignoreEmptyString||""!==r.key){if(this.excludePreDefinedFilters){for(var n=!1,o=0;o<t.length;o++){var h=t[o];if(r.key===h.value){n=!0;break}}if(n)continue}if(i++,i>this.size)break;var l=this._translate(r.key),a={display:l,term:r.key,count:r.doc_count};this.values.push(a)}}}for(var u=this.edge.currentQuery.listMust(es.newTermFilter({field:this.field})),s=0;s<u.length;s++){var d=u[s].value;d=this._translate(d),this.filters.push({display:d,term:u[s].value})}},this.selectTerm=function(e){var t=this.edge.cloneQuery();t.addMust(es.newTermFilter({field:this.field,value:e})),t.from=0,this.edge.pushQuery(t),this.edge.doQuery()},this.removeFilter=function(e){var t=this.edge.cloneQuery();t.removeMust(es.newTermFilter({field:this.field,value:e})),t.from=0,this.edge.pushQuery(t),this.edge.doQuery()},this.changeSize=function(e){this.size=e;var t=this.edge.cloneQuery(),i=t.getAggregation({name:this.id});i.size=this.size,this.edge.pushQuery(t),this.edge.doQuery()},this.changeSort=function(e,t){this.orderBy=e,this.orderDir=t;var i=this.edge.cloneQuery(),s=i.getAggregation({name:this.id});s.setOrdering(this.orderBy,this.orderDir),this.edge.pushQuery(i),this.edge.doQuery()},this._translate=function(e){if(this.valueMap){if(e in this.valueMap)return this.valueMap[e]}else if(this.valueFunction)return this.valueFunction(e);return e}},newORTermSelector:function(e){return e||(e={}),edges.ORTermSelector.prototype=edges.newSelector(e),new edges.ORTermSelector(e)},ORTermSelector:function(e){this.lifecycle=e.lifecycle||"static",this.orderBy=e.orderBy||"term",this.orderDir=e.orderDir||"asc",this.size=e.size||10,this.valueMap=e.valueMap||!1,this.valueFunction=e.valueFunction||!1,this.defaultRenderer=e.defaultRenderer||"newORTermSelectorRenderer",this.terms=e.terms||!1,this.selected=[],this.updating=!1,this.init=function(e){edges.newSelector().init.call(this,e),this.terms||this.listAll()},this.synchronise=function(){this.selected=[];for(var e=this.edge.currentQuery.listMust(es.newTermsFilter({field:this.field})),t=0;t<e.length;t++)for(var i=0;i<e[t].values.length;i++){var s=e[t].values[i];this.selected.push(s)}},this.listAll=function(){var e=this.edge.cloneBaseQuery();e.clearAggregations(),e.size=0;var t={name:this.id,field:this.field,orderBy:this.orderBy,orderDir:this.orderDir,size:this.size};e.addAggregation(es.newTermsAggregation(t)),es.doQuery({search_url:this.edge.search_url,queryobj:e.objectify(),datatype:this.edge.datatype,success:edges.objClosure(this,"listAllQuerySuccess",["result"]),error:edges.objClosure(this,"listAllQueryFail")})},this.listAllQuerySuccess=function(e){var t=e.result;this.terms=[];for(var i=t.buckets(this.id),s=0;s<i.length;s++){var r=i[s];this.terms.push({term:r.key,display:this._translate(r.key),count:r.doc_count})}this.setupEvent(),this.draw()},this.listAllQueryFail=function(){this.terms=[]},this.setupEvent=function(){"update"===this.lifecycle&&(this.edge.context.on("edges:pre-query",edges.eventClosure(this,"doUpdate")),this.doUpdate())},this.doUpdate=function(){if(!this.updating){this.udpating=!0;var e=this.edge.cloneQuery();e.removeMust(es.newTermsFilter({field:this.field})),e.clearAggregations(),e.size=0;var t={name:this.id,field:this.field,orderBy:this.orderBy,orderDir:this.orderDir,size:this.size};e.addAggregation(es.newTermsAggregation(t)),es.doQuery({search_url:this.edge.search_url,queryobj:e.objectify(),datatype:this.edge.datatype,success:edges.objClosure(this,"doUpdateQuerySuccess",["result"]),error:edges.objClosure(this,"doUpdateQueryFail")})}},this.doUpdateQuerySuccess=function(e){for(var t=e.result,i=t.buckets(this.id),s=0;s<this.terms.length;s++){for(var r=this.terms[s],n=!1,o=0;o<i.length;o++){var h=i[o];if(r.term===h.key){r.count=h.doc_count,n=!0;break}}n||(r.count=0)}this.updating=!1,this.draw()},this.doUpdateQueryFail=function(){},this.selectTerm=function(e){var t=this.edge.cloneQuery(),i=t.listMust(es.newTermsFilter({field:this.field}));if(i.length>0){var s=i[0];s.add_term(e)}else t.addMust(es.newTermsFilter({field:this.field,values:[e]}));t.from=0,this.edge.pushQuery(t),this.edge.doQuery()},this.removeFilter=function(e){var t=this.edge.cloneQuery(),i=t.listMust(es.newTermsFilter({field:this.field}));if(i.length>0){var s=i[0];s.has_term(e)&&s.remove_term(e),s.has_terms()||t.removeMust(es.newTermsFilter({field:this.field}))}t.from=0,this.edge.pushQuery(t),this.edge.doQuery()},this._translate=function(e){if(this.valueMap){if(e in this.valueMap)return this.valueMap[e]}else if(this.valueFunction)return this.valueFunction(e);return e}},newBasicRangeSelector:function(e){return e||(e={}),edges.BasicRangeSelector.prototype=edges.newSelector(e),new edges.BasicRangeSelector(e)},BasicRangeSelector:function(e){this.ranges=e.ranges||[],this.formatUnknown=e.formatUnknown||!1,this.defaultRenderer=e.defaultRenderer||"newBasicRangeSelectorRenderer",this.values=[],this.filters=[],this.contrib=function(e){for(var t=[],i=0;i<this.ranges.length;i++){var s=this.ranges[i],r={};s.from&&(r.from=s.from),s.to&&(r.to=s.to),t.push(r)}e.addAggregation(es.newRangeAggregation({name:this.id,field:this.field,ranges:t}))},this.synchronise=function(){if(this.values=[],this.filters=[],this.edge.result)for(var e=this.edge.result.buckets(this.id),t=0;t<this.ranges.length;t++){var i=this.ranges[t],s=this._getRangeBucket(e,i.from,i.to),r=$.extend(!0,{},i);r.count=s.doc_count,this.values.push(r)}if(this.edge.currentQuery)for(var n=this.edge.currentQuery.listMust(es.newRangeFilter({field:this.field})),t=0;t<n.length;t++){var o=n[t].lt,h=n[t].gte,i=this._getRangeDef(h,o);i?this.filters.push(i):this.filters.push({display:this._formatUnknown(h,o),from:h,to:o})}},this.selectRange=function(e,t){var i=this.edge.cloneQuery(),s={field:this.field};e&&(s.gte=e),t&&(s.lt=t),i.addMust(es.newRangeFilter(s)),i.from=0,this.edge.pushQuery(i),this.edge.doQuery()},this.removeFilter=function(e,t){var i=this.edge.cloneQuery(),s={field:this.field};e&&(s.gte=e),t&&(s.lt=t),i.removeMust(es.newRangeFilter(s)),i.from=0,this.edge.pushQuery(i),this.edge.doQuery()},this._getRangeDef=function(e,t){for(var i=0;i<this.ranges.length;i++){var s=this.ranges[i],r=!0,n=!0;if((e&&!s.from||!e&&s.from)&&(r=!1),(t&&!s.to||!t&&s.to)&&(n=!1),e&&s.from&&e!==s.from&&(r=!1),t&&s.to&&t!==s.to&&(n=!1),r&&n)return s}return!1},this._getRangeBucket=function(e,t,i){for(var s=0;s<e.length;s++){var r=e[s],n=!0,o=!0;if((t&&!r.from||!t&&r.from)&&(n=!1),(i&&!r.to||!i&&r.to)&&(o=!1),t&&r.from&&t!==r.from&&(n=!1),i&&r.to&&i!==r.to&&(o=!1),n&&o)return r}return!1},this._formatUnknown=function(e,t){if(this.formatUnknown)return this.formatUnknown(e,t);var i="";return i+=e?e:"< ",t?i+=e?" - "+t:t:e?i+="+":i="unknown",i}},newBasicGeoDistanceRangeSelector:function(e){return e||(e={}),edges.BasicGeoDistanceRangeSelector.prototype=edges.newSelector(e),new edges.BasicGeoDistanceRangeSelector(e)},BasicGeoDistanceRangeSelector:function(e){this.distances=e.distances||[],this.hideEmptyDistance=e.hideEmptyDistance||!0,this.unit=e.unit||"m",this.lat=e.lat||!1,this.lon=e.lon||!1,this.values=[],this.synchronise=function(){this.values=[]}},newDateHistogramSelector:function(e){return e||(e={}),edges.BasicRangeSelector.prototype=edges.newSelector(e),new edges.BasicRangeSelector(e)},DateHistogramSelector:function(e){this.interval=e.interval||"year",this.sort=e.sort||"asc",this.hideEmptyDateBin=e.hideEmptyDateBin||!0,this.shortDisplay=e.shortDisplay||!1,this.values=[],this.synchronise=function(){this.values=[]}},newAutocompleteTermSelector:function(e){return e||(e={}),edges.AutocompleteTermSelector.prototype=edges.newComponent(e),new edges.AutocompleteTermSelector(e)},AutocompleteTermSelector:function(e){this.defaultRenderer=e.defaultRenderer||"newAutocompleteTermSelectorRenderer"}});
$.extend(!0,edges,{bs3:{newFacetview:function(s){return s||(s={}),edges.bs3.Facetview.prototype=edges.newTemplate(s),new edges.bs3.Facetview(s)},Facetview:function(s){this.namespace="edges-bs3-facetview",this.draw=function(s){this.edge=s;var e=edges.css_classes(this.namespace,"container"),i=edges.css_classes(this.namespace,"facets"),d=edges.css_classes(this.namespace,"facet"),c=edges.css_classes(this.namespace,"panel"),a=edges.css_classes(this.namespace,"search-controller"),v=edges.css_classes(this.namespace,"selected-filters"),l=edges.css_classes(this.namespace,"pager"),t=edges.css_classes(this.namespace,"searching"),r=edges.css_classes(this.namespace,"results"),o='<div class="'+e+'"><div class="row">',n=s.category("facet"),g="";if(n.length>0){o+='<div class="col-md-3">                        <div class="'+i+'">{{FACETS}}</div>                    </div>',o+='<div class="col-md-9" class="'+c+'">';for(var h=0;h<n.length;h++)g+='<div class="'+d+'"><div id="'+n[h].id+'"></div></div>'}else o+='<div class="col-md-12" class="'+c+'">';var m=s.category("controller");m.length>0&&(o+='<div class="row"><div class="col-md-12"><div class="'+a+'"><div id="'+m[0].id+'"></div></div></div></div>');var p=s.category("selected-filters");p.length>0&&(o+='<div class="row">                                            <div class="col-md-12">                                                <div class="'+v+'"><div id="'+p[0].id+'"></div></div>                                            </div>                                        </div>');var w=s.category("top-pager");w.length>0&&(o+='<div class="row"><div class="col-md-12"><div class="'+l+'"><div id="'+w[0].id+'"></div></div></div></div>');var f=s.category("searching-notification");f.length>0&&(o+='<div class="row"><div class="col-md-12"><div class="'+t+'"><div id="'+f[0].id+'"></div></div></div></div>');var _=s.category("results");_.length>0&&(o+='<div class="row"><div class="col-md-12"><div class="'+r+'" dir="auto"><div id="'+_[0].id+'"></div></div></div></div>');var y=s.category("bottom-pager");y.length>0&&(o+='<div class="row"><div class="col-md-12"><div class="'+l+'"><div id="'+y[0].id+'"></div></div></div></div>'),o+="</div></div></div>",o=o.replace(/{{FACETS}}/g,g),s.context.html(o)}}}});
$.extend(!0,edges,{bs3:{newTabbed:function(e){return e||(e={}),edges.bs3.Tabbed.prototype=edges.newTemplate(e),new edges.bs3.Tabbed(e)},Tabbed:function(e){this.edge=!1,this.hidden={},this.namespace="edges-bs3-tabbed",this.draw=function(e){this.edge=e;var i='<div id="edges-tabbed-view">{{TOPSTRAP}}<div class="row">',d=e.category("top"),t="";if(d.length>0)for(var s=0;s<d.length;s++)t+='<div class="row"><div class="col-md-12"><div id="'+d[s].id+'"></div></div></div>';var a=e.category("lhs"),n="";if(a.length>0){i+='<div class="col-md-3">                        <div id="edges-tabbed-controls" style="padding-top:45px;">{{CONTROLS}}</div>                    </div>',i+='<div class="col-md-9" id="edges-tabbed-panel">';for(var s=0;s<a.length;s++)n+='<div id="'+a[s].id+'"></div>'}else i+='<div class="col-md-12" id="edges-tabbed-panel">';var c=e.category("tab");i+='<div class="row">                        <div class="col-md-12">                            <ul class="nav nav-tabs">{{TABS}}</ul>                        </div>                    </div>';for(var r="",o="",b=[],s=0;s<c.length;s++){var l=c[s],v="edges-tabbed-container-"+l.id;b.push(l.id),r+='<li><a href="#" id="edges-tabbed-tab-'+l.id+'" data-id="'+l.id+'"><strong>'+l.display+"</strong></a></li>",o+='<div class="edges-tabbed-container" id="'+v+'">                            <div class="row">                                <div class="col-md-12">                                     <div class="tab" id="'+l.id+'"></div>                                </div>                             </div>                        </div>'}i+="{{TAB_CONTENTS}}</div></div>",i=i.replace(/{{CONTROLS}}/g,n),i=i.replace(/{{TABS}}/g,r),i=i.replace(/{{TAB_CONTENTS}}/g,o),i=i.replace(/{{TOPSTRAP}}/g,t),e.context.html(i);for(var s=0;s<b.length;s++)this.hideOffScreen("#edges-tabbed-container-"+b[s]);var g=b[0];this.activateTab(g);for(var s=0;s<b.length;s++)$("#edges-tabbed-tab-"+b[s],this.edge.context).click(edges.eventClosure(this,"tabClicked"))},this.hideOffScreen=function(e){var i=$(e,this.edge.context);e in this.hidden||(this.hidden[e]={position:i.css("position"),margin:i.css("margin-left")},$(e,this.edge.context).css("position","absolute").css("margin-left",-9999))},this.bringIn=function(e){var i=this.hidden[e].position,d=this.hidden[e].margin;$(e,this.edge.context).css("position",i).css("margin-left",d),delete this.hidden[e]},this.activateTab=function(e){for(var i=this.edge.category("tab"),d=0;d<i.length;d++){var t=i[d];t.id===e?(this.bringIn("#edges-tabbed-container-"+t.id),$("#edges-tabbed-tab-"+t.id,this.edge.context).parent().addClass("active")):(this.hideOffScreen("#edges-tabbed-container-"+t.id),$("#edges-tabbed-tab-"+t.id,this.edge.context).parent().removeClass("active"))}},this.tabClicked=function(e){var i=$(e).attr("data-id");this.activateTab(i)}}}});
$.extend(!0,edges,{bs3:{newBasicRangeSelectorRenderer:function(e){return e||(e={}),edges.bs3.BasicRangeSelectorRenderer.prototype=edges.newRenderer(e),new edges.bs3.BasicRangeSelectorRenderer(e)},BasicRangeSelectorRenderer:function(e){this.hideEmptyRange=void 0===e.hideEmptyRange?!0:e.hideEmptyRange,this.open=e.open||!1,this.showSelected=e.showSelected||!0,this.namespace="edges-bs3-basic-range-selector",this.draw=function(){var e="Loading...",s=edges.css_classes(this.namespace,"result",this),t=edges.css_classes(this.namespace,"value",this),i=edges.css_classes(this.namespace,"filter-remove",this),a=edges.css_classes(this.namespace,"facet",this),n=edges.css_classes(this.namespace,"header",this),o=edges.css_id(this.namespace,"toggle",this),c=edges.css_id(this.namespace,"results",this);if(this.component.values.length>0&&(e="",0===this.component.filters.length))for(var l=0;l<this.component.values.length;l++){var h=this.component.values[l];(h.count>0||!this.hideEmptyRange)&&(e+='<div class="'+s+'"><a href="#" class="'+t+'" data-from="'+h.from+'" data-to="'+h.to+'">'+edges.escapeHtml(h.display)+"</a> ("+h.count+")</div>")}var d="";if(this.component.filters.length>0&&this.showSelected)for(var l=0;l<this.component.filters.length;l++){var r=this.component.filters[l];d+='<div class="'+s+'"><strong>'+edges.escapeHtml(r.display)+"&nbsp;",d+='<a href="#" class="'+i+'" data-from="'+r.from+'" data-to="'+r.to+'">',d+='<i class="glyphicon glyphicon-black glyphicon-remove"></i></a>',d+="</strong></a></div>"}var p='<div class="'+a+'">                        <div class="'+n+'"><div class="row">                             <div class="col-md-12">                                <a href="#" id="'+o+'"><i class="glyphicon glyphicon-plus"></i>&nbsp;'+edges.escapeHtml(this.component.display)+'</a>                            </div>                        </div></div>                        <div class="row" style="display:none" id="'+c+'">                            <div class="col-md-12">                                {{SELECTED}}                                {{RESULTS}}                            </div>                        </div></div>';p=p.replace(/{{RESULTS}}/g,e).replace(/{{SELECTED}}/g,d),this.component.context.html(p),this.setUIOpen();var g=edges.css_id_selector(this.namespace,"toggle",this),m=edges.css_class_selector(this.namespace,"value",this),v=edges.css_class_selector(this.namespace,"filter-remove",this);edges.on(g,"click",this,"toggleOpen"),edges.on(m,"click",this,"rangeSelected"),edges.on(v,"click",this,"removeFilter")},this.setUIOpen=function(){var e=edges.css_id_selector(this.namespace,"results",this),s=edges.css_id_selector(this.namespace,"toggle",this),t=this.component.jq(e),i=this.component.jq(s);this.open?(i.find("i").removeClass("glyphicon-plus").addClass("glyphicon-minus"),t.show()):(i.find("i").removeClass("glyphicon-minus").addClass("glyphicon-plus"),t.hide())},this.toggleOpen=function(e){this.open=!this.open,this.setUIOpen()},this.rangeSelected=function(e){var s=this.component.jq(e).attr("data-from"),t=this.component.jq(e).attr("data-to");this.component.selectRange(parseFloat(s),parseFloat(t))},this.removeFilter=function(e){var s=this.component.jq(e).attr("data-from"),t=this.component.jq(e).attr("data-to");this.component.removeFilter(parseFloat(s),parseFloat(t))}}}});
$.extend(!0,edges,{bs3:{newFullSearchControllerRenderer:function(e){return e||(e={}),edges.bs3.FullSearchControllerRenderer.prototype=edges.newRenderer(e),new edges.bs3.FullSearchControllerRenderer(e)},FullSearchControllerRenderer:function(e){this.searchButton=e.searchButton||!1,this.freetextSubmitDelay=edges.getParam(e.freetextSubmitDelay,500),this.fadeIn=e.fadeIn||800,this.shareLink=e.shareLink||!1,this.showShortUrl=!1,this.namespace="edges-bs3-search-controller",this.draw=function(){function e(e){var s=e.keyCode?e.keyCode:e.which;return 13===s}var s=this.component,t="&nbsp;";if(s.sortOptions&&s.sortOptions.length>0){var i=edges.css_classes(this.namespace,"direction",this),n=edges.css_classes(this.namespace,"sortby",this);t='<div class="form-inline">                             <div class="form-group">                                 <div class="input-group">                                     <span class="input-group-btn">                                         <button type="button" class="btn btn-default btn-sm '+i+'" title="" href="#"></button>                                     </span>                                     <select class="form-control input-sm '+n+'">                                         <option value="_score">Relevance</option>';for(var o=0;o<s.sortOptions.length;o++){var c=s.sortOptions[o].field,a=s.sortOptions[o].display;t+='<option value="'+c+'">'+edges.escapeHtml(a)+"</option>"}t+=" </select>                                 </div>                             </div>                         </div>"}var r="";if(s.fieldOptions&&s.fieldOptions.length>0){var l=edges.css_classes(this.namespace,"field",this);r+='<select class="form-control input-sm '+l+'" style="width: 120px">',r+='<option value="">search all</option>';for(var o=0;o<s.fieldOptions.length;o++){var h=s.fieldOptions[o];r+='<option value="'+h.field+'">'+edges.escapeHtml(h.display)+"</option>"}r+="</select>"}var p=edges.css_classes(this.namespace,"reset",this),d=edges.css_classes(this.namespace,"text",this),g=edges.css_classes(this.namespace,"search",this),m=edges.css_id(this.namespace,"text",this),u='<div class="form-inline pull-right">                         <div class="form-group">                             <div class="input-group">                                 <span class="input-group-btn">                                     <button type="button" class="btn btn-danger btn-sm '+p+'" title="Clear all search parameters and start again">                                         <span class="glyphicon glyphicon-remove"></span>                                     </button>                                 </span> '+r+'                                <input type="text" id="'+m+'" class="form-control input-sm '+d+'" name="q" value="" placeholder="Search" style="width: 200px" />                                 <span class="input-group-btn">                                     <button type="button" class="btn btn-info btn-sm '+g+'">                                         <span class="glyphicon glyphicon-white glyphicon-search"></span>                                     </button>                                 </span>                             </div>                         </div>                     </div>',v='<div class="row"><div class="col-md-5">{{SORT}}</div><div class="col-md-7">{{SEARCH}}</div></div>';if(v=v.replace(/{{SORT}}/g,t).replace(/{{SEARCH}}/g,u),s.context.html(v),s.sortOptions&&s.sortOptions.length>0&&(this.setUISortDir(),this.setUISortField()),s.fieldOptions&&s.fieldOptions.length>0&&this.setUISearchField(),this.setUISearchText(),s.sortOptions&&s.sortOptions.length>0){var f=edges.css_class_selector(this.namespace,"direction",this),S=edges.css_class_selector(this.namespace,"sortby",this);edges.on(f,"click",this,"changeSortDir"),edges.on(S,"change",this,"changeSortBy")}if(s.fieldOptions&&s.fieldOptions.length>0){var y=edges.css_class_selector(this.namespace,"field",this);edges.on(y,"change",this,"changeSearchField")}var b=edges.css_class_selector(this.namespace,"text",this);this.freetextSubmitDelay>-1?edges.on(b,"keyup",this,"setSearchText",this.freetextSubmitDelay):edges.on(b,"keyup",this,"setSearchText",!1,e);var _=edges.css_class_selector(this.namespace,"reset",this);edges.on(_,"click",this,"clearSearch");var x=edges.css_class_selector(this.namespace,"search",this);edges.on(x,"click",this,"doSearch")},this.setUISortDir=function(){var e=edges.css_class_selector(this.namespace,"direction",this),s=this.component.jq(e);"asc"===this.component.sortDir?(s.html('sort <i class="glyphicon glyphicon-arrow-up"></i> by'),s.attr("title","Current order ascending. Click to change to descending")):(s.html('sort <i class="glyphicon glyphicon-arrow-down"></i> by'),s.attr("title","Current order descending. Click to change to ascending"))},this.setUISortField=function(){if(this.component.sortBy){var e=edges.css_class_selector(this.namespace,"sortby",this),s=this.component.jq(e);s.val(this.component.sortBy)}},this.setUISearchField=function(){if(this.component.searchField){var e=edges.css_class_selector(this.namespace,"field",this),s=this.component.jq(e);s.val(this.component.searchField)}},this.setUISearchText=function(){if(this.component.searchString){var e=edges.css_class_selector(this.namespace,"text",this),s=this.component.jq(e);s.val(this.component.searchString)}},this.changeSortDir=function(e){this.component.changeSortDir()},this.changeSortBy=function(e){var s=this.component.jq(e).val();this.component.setSortBy(s)},this.changeSearchField=function(e){var s=this.component.jq(e).val();this.component.setSearchField(s)},this.setSearchText=function(e){var s=this.component.jq(e).val();this.component.setSearchText(s)},this.clearSearch=function(e){this.component.clearSearch()},this.doSearch=function(e){var s=edges.css_id_selector(this.namespace,"text",this),t=this.component.jq(s).val();this.component.setSearchText(t)}}}});
$.extend(!0,edges,{bs3:{newMultiDateRangeRenderer:function(e){return e||(e={}),edges.bs3.MultiDateRangeRenderer.prototype=edges.newRenderer(e),new edges.bs3.MultiDateRangeRenderer(e)},MultiDateRangeRenderer:function(e){this.dre=!1,this.selectId=!1,this.fromId=!1,this.toId=!1,this.selectJq=!1,this.fromJq=!1,this.toJq=!1,this.draw=function(){var e=this.component;this.selectId=e.id+"_date-type",this.fromId=e.id+"_date-from",this.toId=e.id+"_date-to";for(var t="",a=0;a<e.fields.length;a++){var i=e.fields[a],s=e.currentField==i.field?' selected="selected" ':"";t+='<option value="'+i.field+'"'+s+">"+i.display+"</option>"}var d='<select class="multi-date-range-select" name="'+this.selectId+'" id="'+this.selectId+'">'+t+"</select><br>";d+='<label for="'+this.fromId+'">From</label>                    <input class="multi-date-range-input" type="text" name="'+this.fromId+'" id="'+this.fromId+'" placeholder="earliest date">                    <label for="'+this.toId+'">To</label>                    <input class="multi-date-range-input" type="text" name="'+this.toId+'" id="'+this.toId+'" placeholder="latest date">',e.context.html(d),this.selectJq=e.jq("#"+this.selectId),this.fromJq=e.jq("#"+this.fromId),this.toJq=e.jq("#"+this.toId),this.fromJq.datepicker({dateFormat:"dd-mm-yy",constrainInput:!0,changeYear:!0,maxDate:0}).bind("change",edges.eventClosure(this,"dateChanged")),this.toJq.datepicker({dateFormat:"dd-mm-yy",constrainInput:!0,defaultDate:0,changeYear:!0,maxDate:0}).bind("change",edges.eventClosure(this,"dateChanged")),this.selectJq.select2().bind("change",edges.eventClosure(this,"dateChanged")),this.prepDates()},this.dateChanged=function(e){var t=this.selectJq.select2("val");this.component.changeField(t);var a=this.fromJq.val();a?(a=$.datepicker.parseDate("dd-mm-yy",a),a=$.datepicker.formatDate("yy-mm-dd",a),this.component.setFrom(a)):this.component.setFrom(!1);var i=this.toJq.val();i?(i=$.datepicker.parseDate("dd-mm-yy",i),i=$.datepicker.formatDate("yy-mm-dd",i),this.component.setTo(i)):this.component.setTo(!1),this.component.triggerSearch()},this.prepDates=function(){var e=this.component.currentEarliest(),t=this.component.currentLatest(),a=this.component.fromDate,i=this.component.toDate;e&&(this.fromJq.datepicker("option","minDate",e),this.fromJq.datepicker("option","defaultDate",e),this.toJq.datepicker("option","minDate",e)),t&&(this.fromJq.datepicker("option","maxDate",t),this.toJq.datepicker("option","maxDate",t),this.toJq.datepicker("option","defaultDate",t)),a&&(a=$.datepicker.parseDate("yy-mm-dd",a),a=$.datepicker.formatDate("dd-mm-yy",a),this.fromJq.val(a)),i&&(i=$.datepicker.parseDate("yy-mm-dd",i),i=$.datepicker.formatDate("dd-mm-yy",i),this.toJq.val(i))}}}});
$.extend(!0,edges,{bs3:{newNumericRangeEntryRenderer:function(s){return s||(s={}),edges.bs3.NumericRangeEntryRenderer.prototype=edges.newRenderer(s),new edges.bs3.NumericRangeEntryRenderer(s)},NumericRangeEntryRenderer:function(s){this.fromText="From",this.toText="To",this.namespace="edges-bs3-numeric-range-entry",this.draw=function(){for(var s=edges.css_classes(this.namespace,"facet",this),e=edges.css_classes(this.namespace,"header",this),t=edges.css_classes(this.namespace,"label",this),i=edges.css_classes(this.namespace,"select",this),n=edges.css_id(this.namespace,"toggle",this),o=edges.css_id(this.namespace,"form",this),c=edges.css_id(this.namespace,"from",this),a=edges.css_id(this.namespace,"to",this),h="",d=[],r=this.component.lower===!1?0:this.component.lower,l=this.component.upper===!1?0:this.component.upper,p=r;l>p;p+=this.component.increment)d.push(p);d.push(l);for(var m="",p=0;p<d.length;p++)m+='<option value="'+d[p]+'">'+d[p]+"</option>";h+='<div class="row"><div class="col-md-4"><span class="'+t+'">'+this.fromText+"</span></div>",h+='<div class="col-md-8"><select name="'+c+'" id="'+c+'" class="form-control '+i+'">'+m+"</select></div>",h+="</div>",h+='<div class="row"><div class="col-md-4"><span class="'+t+'">'+this.toText+"</span></div>",h+='<div class="col-md-8"><select name="'+a+'" id="'+a+'" class="form-control '+i+'">'+m+"</select></div>",h+="</div></div>";var g='<div class="'+s+'">                        <div class="'+e+'"><div class="row">                             <div class="col-md-12">                                <a href="#" id="'+n+'"><i class="glyphicon glyphicon-plus"></i>&nbsp;'+this.component.display+'</a>                            </div>                        </div></div>                        <div class="row" style="display:none" id="'+o+'">                            <div class="col-md-12">                                <form>{{THEFORM}}</form>                            </div>                        </div></div>';g=g.replace(/{{THEFORM}}/g,h),this.component.context.html(g),this.setUIFrom(),this.setUITo(),this.setUIOpen();var v=edges.css_id_selector(this.namespace,"from",this),f=edges.css_id_selector(this.namespace,"to",this),_=edges.css_id_selector(this.namespace,"toggle",this);edges.on(v,"change",this,"fromChanged"),edges.on(f,"change",this,"toChanged"),edges.on(_,"click",this,"toggleOpen")},this.setUIOpen=function(){var s=edges.css_id_selector(this.namespace,"form",this),e=edges.css_id_selector(this.namespace,"toggle",this),t=this.component.jq(s),i=this.component.jq(e);this.open?(i.find("i").removeClass("glyphicon-plus").addClass("glyphicon-minus"),t.show()):(i.find("i").removeClass("glyphicon-minus").addClass("glyphicon-plus"),t.hide())},this.setUIFrom=function(){if(this.component.from){var s=edges.css_id_selector(this.namespace,"from",this),e=this.component.jq(s);e.val(this.component.from)}},this.setUITo=function(){if(this.component.to){var s=edges.css_id_selector(this.namespace,"to",this),e=this.component.jq(s);e.val(this.component.to)}},this.toggleOpen=function(s){this.open=!this.open,this.setUIOpen()},this.fromChanged=function(s){var e=parseInt($(s).val()),t=edges.css_id_selector(this.namespace,"to",this),i=this.component.jq(t),n=parseInt(i.val());e>n&&(n=e,i.val(e)),this.component.selectRange(e,n)},this.toChanged=function(s){var e=parseInt($(s).val()),t=edges.css_id_selector(this.namespace,"from",this),i=this.component.jq(t),n=parseInt(i.val());n>e&&(n=e,i.val(e)),this.component.selectRange(n,e)}}}});
$.extend(!0,edges,{bs3:{newORTermSelectorRenderer:function(e){return e||(e={}),edges.bs3.ORTermSelectorRenderer.prototype=edges.newRenderer(e),new edges.bs3.ORTermSelectorRenderer(e)},ORTermSelectorRenderer:function(e){this.open=void 0!==e.open?e.open:!1,this.togglable=void 0!==e.togglable?e.togglable:!0,this.showCount=e.showCount||!1,this.hideEmpty=e.hideEmpty||!1,this.namespace="edges-bs3-or-term-selector",this.draw=function(){var e=this.component,s=this.namespace,t=edges.css_classes(s,"result",this),i=edges.css_classes(s,"value",this),l=edges.css_classes(s,"filter-remove",this),c=edges.css_classes(s,"facet",this),o=edges.css_classes(s,"header",this),n=edges.css_classes(s,"selections",this),r=edges.css_id(s,"toggle",this),d=edges.css_id(s,"results",this),a="Loading...";if(e.terms.length>0){a="";for(var h=0;h<e.terms.length;h++){var g=e.terms[h];0===g.count&&this.hideEmpty||-1===$.inArray(g.term.toString(),e.selected)&&(a+='<div class="'+t+'"><a href="#" class="'+i+'" data-key="'+edges.escapeHtml(g.term)+'">'+edges.escapeHtml(g.display)+"</a>",this.showCount&&(a+=" ("+g.count+")"),a+="</div>")}}var p="";if(e.selected.length>0)for(var h=0;h<e.selected.length;h++){var m=e.selected[h],v=this._getFilterDef(m);v&&(p+='<div class="'+t+'"><strong>'+edges.escapeHtml(v.display),this.showCount&&(p+=" ("+v.count+")"),p+='&nbsp;<a href="#" class="'+l+'" data-key="'+edges.escapeHtml(v.term)+'">',p+='<i class="glyphicon glyphicon-black glyphicon-remove"></i></a>',p+="</strong></a></div>")}var u="";this.togglable&&(u='<a href="#" id="'+r+'"><i class="glyphicon glyphicon-plus"></i>&nbsp;');var f='<div class="'+c+'">                        <div class="'+o+'"><div class="row">                             <div class="col-md-12">                                '+u+e.display+'</a>                            </div>                        </div></div>                        <div class="row" style="display:none" id="'+d+'">                            <div class="col-md-12">                                {{SELECTED}}                            </div>                            <div class="col-md-12"><div class="'+n+'">                                {{RESULTS}}                            </div></div>                        </div></div>';f=f.replace(/{{RESULTS}}/g,a).replace(/{{SELECTED}}/g,p),e.context.html(f),this.setUIOpen();var y=edges.css_class_selector(s,"value",this),_=edges.css_class_selector(s,"filter-remove",this),S=edges.css_id_selector(s,"toggle",this);edges.on(y,"click",this,"termSelected"),edges.on(S,"click",this,"toggleOpen"),edges.on(_,"click",this,"removeFilter")},this.setUIOpen=function(){var e=edges.css_id_selector(this.namespace,"results",this),s=edges.css_id_selector(this.namespace,"toggle",this),t=this.component.jq(e),i=this.component.jq(s);this.open?(i.find("i").removeClass("glyphicon-plus").addClass("glyphicon-minus"),t.show()):(i.find("i").removeClass("glyphicon-minus").addClass("glyphicon-plus"),t.hide())},this.termSelected=function(e){var s=this.component.jq(e).attr("data-key");this.component.selectTerm(s)},this.removeFilter=function(e){var s=this.component.jq(e).attr("data-key");this.component.removeFilter(s)},this.toggleOpen=function(e){this.open=!this.open,this.setUIOpen()},this._getFilterDef=function(e){for(var s=0;s<this.component.terms.length;s++){var t=this.component.terms[s];if(e===t.term)return t}return!1}}}});
$.extend(!0,edges,{bs3:{newPagerRenderer:function(s){return s||(s={}),edges.bs3.PagerRenderer.prototype=edges.newRenderer(s),new edges.bs3.PagerRenderer(s)},PagerRenderer:function(s){this.scroll=s.scroll||!0,this.scrollSelector=s.scrollSelector||"body",this.sizeOptions=s.sizeOptions||[10,25,50,100],this.namespace="edges-bs3-pager",this.draw=function(){if(this.component.total===!1||0===this.component.total)return void this.component.context.html("");var s=edges.css_classes(this.namespace,"container",this),e=edges.css_classes(this.namespace,"total",this),t=edges.css_classes(this.namespace,"nav",this),i=edges.css_classes(this.namespace,"first",this),o=edges.css_classes(this.namespace,"prev",this),c=edges.css_classes(this.namespace,"page",this),n=edges.css_classes(this.namespace,"next",this),a=edges.css_classes(this.namespace,"size",this),l='<span class="'+e+'">'+this.component.total+"</span> results found",r='<div class="form-inline">'+l+'<div class="form-group"><select class="form-control input-sm '+a+'" name="'+this.component.id+'-page-size">{{SIZES}}</select></div> per page</div>',h="",p=this.sizeOptions.slice(0);-1===$.inArray(this.component.pageSize,p)&&p.push(this.component.pageSize),p.sort(function(s,e){return s-e});for(var d=0;d<p.length;d++){var g=p[d],m="";g===this.component.pageSize&&(m="selected='selected'"),h+='<option name="'+g+'" '+m+">"+g+"</option>"}r=r.replace(/{{SIZES}}/g,h);var v='<a href="#" class="'+i+'">First</a>',f='<a href="#" class="'+o+'">Prev</a>';1===this.component.page&&(v='<span class="'+i+' disabled">First</span>',f='<span class="'+o+' disabled">Prev</span>');var S='<a href="#" class="'+n+'">Next</a>';this.component.page===this.component.totalPages&&(S='<span class="'+n+' disabled">Next</a>');var u='<div class="'+t+'">'+v+f+'<span class="'+c+'">Page '+this.component.page+" of "+this.component.totalPages+"</span>"+S+"</div>",_='<div class="'+s+'"><div class="row"><div class="col-md-6">{{COUNT}}</div><div class="col-md-6">{{NAV}}</div></div></div>';_=_.replace(/{{COUNT}}/g,r).replace(/{{NAV}}/g,u),this.component.context.html(_);var P=edges.css_class_selector(this.namespace,"first",this),z=edges.css_class_selector(this.namespace,"prev",this),x=edges.css_class_selector(this.namespace,"next",this),T=edges.css_class_selector(this.namespace,"size",this);1!==this.component.page&&(edges.on(P,"click",this,"goToFirst"),edges.on(z,"click",this,"goToPrev")),this.component.page!==this.component.totalPages&&edges.on(x,"click",this,"goToNext"),edges.on(T,"change",this,"changeSize")},this.doScroll=function(){$(this.scrollSelector).animate({scrollTop:$(this.scrollSelector).offset().top},1)},this.goToFirst=function(s){this.scroll&&this.doScroll(),this.component.setFrom(1)},this.goToPrev=function(s){this.scroll&&this.doScroll(),this.component.decrementPage()},this.goToNext=function(s){this.scroll&&this.doScroll(),this.component.incrementPage()},this.changeSize=function(s){var e=$(s).val();this.component.setSize(e)}}}});
$.extend(!0,edges,{bs3:{newRefiningANDTermSelectorRenderer:function(e){return e||(e={}),edges.bs3.RefiningANDTermSelectorRenderer.prototype=edges.newRenderer(e),new edges.bs3.RefiningANDTermSelectorRenderer(e)},RefiningANDTermSelectorRenderer:function(e){this.hideInactive=e.hideInactive||!1,this.controls=e.controls||!0,this.open=e.open||!1,this.showSelected=e.showSelected||!0,this.sortCycle=e.sortCycle||["count desc","count asc","term desc","term asc"],this.namespace="edges-bs3-refiningand-term-selector",this.draw=function(){var e=this.component,s=this.namespace,t=edges.css_classes(s,"result",this),i=edges.css_classes(s,"value",this),n=edges.css_classes(s,"controls",this),o=edges.css_classes(s,"filter-remove",this),c=edges.css_classes(s,"facet",this),r=edges.css_classes(s,"header",this),l=edges.css_id(s,"controls",this),d=edges.css_id(s,"size",this),a=edges.css_id(s,"order",this),h=edges.css_id(s,"toggle",this),g=edges.css_id(s,"results",this),p="Loading...";if(e.values.length>0){p="";for(var m=[],v=0;v<e.filters.length;v++)m.push(e.filters[v].term.toString());for(var v=0;v<e.values.length;v++){var u=e.values[v];-1===$.inArray(u.term.toString(),m)&&(p+='<div class="'+t+'"><a href="#" class="'+i+'" data-key="'+edges.escapeHtml(u.term)+'">'+edges.escapeHtml(u.display)+"</a> ("+u.count+")</div>")}}var y="";if(this.controls){y='<div class="'+n+'" style="display:none" id="'+l+'"><div class="row">                         <div class="col-md-12">                            <div class="btn-group">                                <button type="button" class="btn btn-default btn-sm" id="'+d+'" title="List Size" href="#">0</button>                                 <button type="button" class="btn btn-default btn-sm" id="'+a+'" title="List Order" href="#"></button>                             </div>                        </div>                    </div></div>'}var f="";if(e.filters.length>0&&this.showSelected)for(var v=0;v<e.filters.length;v++){var _=e.filters[v];f+='<div class="'+t+'"><strong>'+edges.escapeHtml(_.display)+"&nbsp;",f+='<a href="#" class="'+o+'" data-key="'+edges.escapeHtml(_.term)+'">',f+='<i class="glyphicon glyphicon-black glyphicon-remove"></i></a>',f+="</strong></a></div>"}var S='<div class="'+c+'">                        <div class="'+r+'"><div class="row">                             <div class="col-md-12">                                <a href="#" id="'+h+'"><i class="glyphicon glyphicon-plus"></i>&nbsp;'+e.display+'</a>                            </div>                        </div></div>                        {{CONTROLS}}                        <div class="row" style="display:none" id="'+g+'">                            <div class="col-md-12">                                {{SELECTED}}                                {{RESULTS}}                            </div>                        </div></div>';S=S.replace(/{{RESULTS}}/g,p).replace(/{{CONTROLS}}/g,y).replace(/{{SELECTED}}/g,f),e.context.html(S),this.setUISize(),this.setUISort(),this.setUIOpen();var b=edges.css_class_selector(s,"value",this),w=edges.css_class_selector(s,"filter-remove",this),z=edges.css_id_selector(s,"toggle",this),C=edges.css_id_selector(s,"size",this),R=edges.css_id_selector(s,"order",this);edges.on(b,"click",this,"termSelected"),edges.on(z,"click",this,"toggleOpen"),edges.on(w,"click",this,"removeFilter"),edges.on(C,"click",this,"changeSize"),edges.on(R,"click",this,"changeSort")},this.setUIOpen=function(){var e=edges.css_id_selector(this.namespace,"results",this),s=edges.css_id_selector(this.namespace,"controls",this),t=edges.css_id_selector(this.namespace,"toggle",this),i=this.component.jq(e),n=this.component.jq(s),o=this.component.jq(t);this.open?(o.find("i").removeClass("glyphicon-plus").addClass("glyphicon-minus"),n.show(),i.show()):(o.find("i").removeClass("glyphicon-minus").addClass("glyphicon-plus"),n.hide(),i.hide())},this.setUISize=function(){var e=edges.css_id_selector(this.namespace,"size",this);this.component.jq(e).html(this.component.size)},this.setUISort=function(){var e=edges.css_id_selector(this.namespace,"order",this),s=this.component.jq(e);"count"===this.component.orderBy?"asc"===this.component.orderDir?s.html('count <i class="glyphicon glyphicon-arrow-down"></i>'):"desc"===this.component.orderDir&&s.html('count <i class="glyphicon glyphicon-arrow-up"></i>'):"term"===this.component.orderBy&&("asc"===this.component.orderDir?s.html('a-z <i class="glyphicon glyphicon-arrow-down"></i>'):"desc"===this.component.orderDir&&s.html('a-z <i class="glyphicon glyphicon-arrow-up"></i>'))},this.termSelected=function(e){var s=this.component.jq(e).attr("data-key");this.component.selectTerm(s)},this.removeFilter=function(e){var s=this.component.jq(e).attr("data-key");this.component.removeFilter(s)},this.toggleOpen=function(e){this.open=!this.open,this.setUIOpen()},this.changeSize=function(e){var s=prompt("Currently displaying "+this.component.size+" results per page. How many would you like instead?");s&&this.component.changeSize(parseInt(s))},this.changeSort=function(e){var s=this.component.orderBy+" "+this.component.orderDir,t=$.inArray(s,this.sortCycle),i=this.sortCycle[(t+1)%4],n=i.split(" ");this.component.changeSort(n[0],n[1])}}}});
$.extend(!0,edges,{bs3:{newResultsDisplayRenderer:function(s){return s||(s={}),edges.bs3.ResultsDisplayRenderer.prototype=edges.newRenderer(s),new edges.bs3.ResultsDisplayRenderer(s)},ResultsDisplayRenderer:function(s){this.noResultsText=s.noResultsText||"No results to display",this.fieldDisplayMap=s.fieldDisplayMap||[],this.arrayValueJoin=s.arrayValueJoin||", ",this.renderFields=[],this.displayMap={},this.namespace="edges-bs-results-display",this.init=function(s){if(Object.getPrototypeOf(this).init.call(this,s),this.fieldDisplayMap.length>0)for(var e=0;e<this.fieldDisplayMap.length;e++)this.renderFields.push(this.fieldDisplayMap[e].field),this.displayMap[this.fieldDisplayMap[e].field]=this.fieldDisplayMap[e].display},this.draw=function(){var s=this.noResultsText;this.component.results===!1&&(s="");var e=this.component.results;if(e&&e.length>0){var i=edges.css_classes(this.namespace,"record",this);s="";for(var t=0;t<e.length;t++){var a=this._renderResult(e[t]);s+='<div class="row"><div class="col-md-12"><div class="'+i+'">'+a+"</div></div></div>"}}var l=edges.css_classes(this.namespace,"container",this),n='<div class="'+l+'">'+s+"</div>";this.component.context.html(n)},this._renderResult=function(s){var e=edges.css_classes(this.namespace,"row",this),i=edges.css_classes(this.namespace,"field",this),t=edges.css_classes(this.namespace,"value",this),a=this.renderFields;0===a.length&&(a=Object.keys(s));for(var l="",n=0;n<a.length;n++){var r=a[n],d=this._getValue(r,s);r in this.displayMap&&(r=this.displayMap[r]),d&&(l+='<div class="'+e+'">                                 <span class="'+i+'">'+edges.escapeHtml(r)+'</span>                                 <span class="'+t+'">'+edges.escapeHtml(d)+"</span>                             </div>")}return l},this._getValue=function(s,e){for(var i=s.split("."),t=e,a=0;a<i.length;a++){var l=i[a];if(!(l in t))return!1;t=t[l]}return $.isArray(t)?t=t.join(this.arrayValueJoin):$.isPlainObject(t)&&(t=!1),t}}}});
$.extend(!0,edges,{bs3:{newSearchingNotificationRenderer:function(e){return e||(e={}),edges.bs3.SearchingNotificationRenderer.prototype=edges.newRenderer(e),new edges.bs3.SearchingNotificationRenderer(e)},SearchingNotificationRenderer:function(e){this.searchingMessage=e.searchingMessage||"Loading, please wait...",this.namespace="edges-bs3-searching-notification",this.draw=function(){var e="";if(this.component.searching){var s=edges.css_classes(this.namespace,"bar",this);e='<div class="progress-bar progress-bar-info progress-bar-striped active '+s+'">                             '+this.searchingMessage+"                         </div>"}this.component.context.html(e)}}}});
$.extend(!0,edges,{bs3:{newSelectedFiltersRenderer:function(e){return e||(e={}),edges.bs3.SelectedFiltersRenderer.prototype=edges.newRenderer(e),new edges.bs3.SelectedFiltersRenderer(e)},SelectedFiltersRenderer:function(e){this.showFilterField=e.showFilterField||!0,this.namespace="edges-bs3-selected-filters",this.draw=function(){for(var e=this.component,s=this.namespace,t=edges.css_classes(s,"field",this),a=edges.css_classes(s,"fieldname",this),l=edges.css_classes(s,"value",this),r=edges.css_classes(s,"remove",this),i=edges.css_classes(s,"rel",this),o=edges.css_classes(s,"container",this),c="",n=Object.keys(e.mustFilters),d=0;d<n.length;d++){var h=n[d],f=e.mustFilters[h];c+='<span class="'+t+'">',this.showFilterField&&(c+='<span class="'+a+'">'+f.display+":</span>");for(var m=0;m<f.values.length;m++){var v=f.values[m];if(c+='<span class="'+l+'">'+v.display+"</span>","term"==f.filter||"terms"===f.filter)c+='<a class="'+r+'" data-bool="must" data-filter="'+f.filter+'" data-field="'+h+'" data-value="'+v.val+'" alt="Remove" title="Remove" href="#">',c+='<i class="glyphicon glyphicon-black glyphicon-remove"></i>',c+="</a>";else if("range"===f.filter){var p=v.from?' data-from="'+v.from+'" ':"",g=v.to?' data-to="'+v.to+'" ':"";c+='<a class="'+r+'" data-bool="must" data-filter="'+f.filter+'" data-field="'+h+'" '+p+g+' alt="Remove" title="Remove" href="#">',c+='<i class="glyphicon glyphicon-black glyphicon-remove"></i>',c+="</a>"}f.rel&&m+1<f.values.length&&(c+='<span class="'+i+'">'+f.rel+"</span>")}c+="</span>"}if(""!==c){var F='<div class="'+o+'">{{FILTERS}}</div>';F=F.replace(/{{FILTERS}}/g,c),e.context.html(F);var u=edges.css_class_selector(s,"remove",this);edges.on(u,"click",this,"removeFilter")}else e.context.html("")},this.removeFilter=function(e){var s=this.component.jq(e),t=s.attr("data-field"),a=s.attr("data-filter"),l=s.attr("data-bool"),r=!1;if("terms"===a||"term"===a)r=s.attr("data-value");else if("range"===a){r={};var i=s.attr("data-from"),o=s.attr("data-to");i&&(r.from=parseInt(i)),o&&(r.to=parseInt(o))}this.component.removeFilter(l,a,t,r)}}}});
$.extend(!0,edges,{bs3:{newTabularResultsRenderer:function(e){return e||(e={}),edges.bs3.TabularResultsRenderer.prototype=edges.newRenderer(e),new edges.bs3.TabularResultsRenderer(e)},TabularResultsRenderer:function(e){this.noResultsText=e.noResultsText||"No results to display",this.defaultCellContent=e.defaultCellContent||"-",this.fieldDisplay=e.fieldDisplay||[],this.namespace="edges-bs3-tabular-results",this.draw=function(){var e=this.noResultsText;this.component.results===!1&&(e="");var s=this.component.results;if(s&&s.length>0){var e='<div class="table-responsive">',t=edges.css_classes(this.namespace,"table",this),l=edges.css_classes(this.namespace,"header",this),a=edges.css_classes(this.namespace,"cell",this);e+='<table class="'+t+'"><thead><tr>_HEADERS_</tr></thead><tbody>';for(var d="",i=0;i<this.fieldDisplay.length;i++){var n=this.fieldDisplay[i].display;d+='<td class="'+l+'">'+n+"</td>"}e=e.replace(/_HEADERS_/g,d);for(var i=0;i<s.length;i++){var r=s[i];e+="<tr>";for(var h=0;h<this.fieldDisplay.length;h++){var c=this.fieldDisplay[h],o=c["default"]?c["default"]:this.defaultCellContent,u=edges.objVal(c.field,r,o),p=edges.css_classes(this.namespace,"cell-"+edges.escapeHtml(c.field),this);e+='<td class="'+a+" "+p+'">'+edges.escapeHtml(u)+"</td>"}e+="</tr>"}e+="</tbody></table></div>"}this.component.context.html(e)}}}});
$.extend(edges,{d3:{newGroupedUSStates:function(e){return e||(e={}),edges.d3.GroupedUSStates.prototype=edges.newRenderer(e),new edges.d3.GroupedUSStates(e)},GroupedUSStates:function(e){this.namespace="edges-d3-grouped-us-states",this.loaded=!1,this.draw=function(){if(!this.loaded){this.component.context.html("");var e=this.component.context.get(0),t=edges.css_classes(this.namespace,"tooltip",this),a=(edges.css_classes(this.namespace,"legend",this),edges.css_classes(this.namespace,"map",this)),s=960,n=500,r=d3.geo.albersUsa().translate([s/2,n/2]).scale([1e3]),i=d3.geo.path().projection(r),o=d3.scale.linear().range(["#6699ff","#99cc00","#9966ff","#ff6666","#ffcc66","#eeeeee"]),d=["PADD1","PADD2","PADD3","PADD4","PADD5","Oops, wrong state name"],p=1e4,l=2e4,c=3e4,h=4e4,f=5e4,u=d3.select(e).append("svg").attr("width",s).attr("height",n).attr("class",a),g=d3.select(e).append("div").attr("class",t).style("opacity",0);o.domain([0,1,2,3,4,5]),d3.json("/static/data/padd/us-states.json",function(t){u.selectAll("path").data(t.features).enter().append("path").attr("d",i).style("stroke","#fff").style("stroke-width","1").style("fill",function(e){var t=["Washington","Oregon","Nevada","California","Arizona","Alaska","Hawaii"],a=["Montana","Wyoming","Idaho","Utah","Colorado"],s=["New Mexico","Louisiana","Texas","Arkansas","Alabama","Mississippi"],n=["North Dakota","South Dakota","Nebraska","Kansas","Minnesota","Oklahoma","Iowa","Missouri","Wisconsin","Michigan","Illinois","Indiana","Ohio","Kentucky","Tennessee"],r=["Maine","Vermont","New Hampshire","Massachusetts","Connecticut","Rhode Island","New York","New Jersey","Pennsylvania","Maryland","Delaware","West Virginia","Virginia","North Carolina","South Carolina","Georgia","Florida"],i=e.properties.name;return-1!==r.indexOf(i)?"#6699ff":-1!==n.indexOf(i)?"#99cc00":-1!==s.indexOf(i)?"#9966ff":-1!==a.indexOf(i)?"#ff6666":-1!==t.indexOf(i)?"#ffcc66":"#eeeeee"}).on("mouseover",function(e){var t=d3.mouse(u.node()).map(function(e){return parseInt(e)});g.transition().duration(200).style("opacity",1),g.html("<h4>"+e.properties.name+"</h4><p>Last month: 25000</p><p>Prediction: 30000</p>").attr("style","left:"+(t[0]+15)+"px; top:"+(t[1]-35)+"px").style("color","white")}),u.selectAll("text").data(t.features).enter().append("svg:text").text(function(e){return"North Carolina"===e.properties.name?p:"Iowa"===e.properties.name?l:"Texas"===e.properties.name?c:"Wyoming"===e.properties.name?h:"Nevada"===e.properties.name?f:""}).attr("x",function(e){return i.centroid(e)[0]}).attr("y",function(e){return i.centroid(e)[1]}).attr("text-anchor","middle").attr("font-size","36pt").attr("stroke","white").attr("stroke-width","1px").attr("font-weight","bold").attr("fill","#4d4d4d");var a=d3.select(e).append("svg").attr("class",a).attr("width",150).attr("height",200).selectAll("g").data(o.domain().slice()).enter().append("g").attr("transform",function(e,t){return"translate(0,"+20*t+")"});a.append("rect").attr("width",18).attr("height",18).style("fill",o),a.append("text").data(d).attr("x",24).attr("y",9).attr("dy",".35em").text(function(e){return e})}),this.loaded=!0}}}}});
$.extend(edges,{google:{newMapViewRenderer:function(e){return e||(e={}),edges.google.MapViewRenderer.prototype=edges.newRenderer(e),new edges.google.MapViewRenderer(e)},MapViewRenderer:function(e){this.onNoGeoPoints=e.onNoGeoPoints||"render",this.mapHiddenText=void 0!==e.mapHiddenText?e.mapHiddenText:"No map data available",this.initialZoom=e.initialZoom||2,this.mapType=e.mapType||"hybrid",this.namespace="edges-google-map-view",this.map=!1,this.markers=[],this.draw=function(){try{google}catch(e){return}if(0==this.component.locations.length&&"hide"===this.onNoGeoPoints)return void this.component.context.html(this.mapHiddenText);var t=new google.maps.LatLng(this.component.centre.lat,this.component.centre.lon);if(!this.map){var o=edges.css_classes(this.namespace,"canvas",this),s=edges.css_class_selector(this.namespace,"canvas",this);this.component.context.html('<div class="'+o+'"></div>');var n=this.component.jq(s)[0],i=this.mapType;"hybrid"===this.mapType&&(i=google.maps.MapTypeId.HYBRID);var a={zoom:this.initialZoom,center:t,mapTypeId:i};this.map=new google.maps.Map(n,a)}for(this.map.setCenter(t),p=0;p<this.markers.length;p++)this.markers[p].setMap(null);this.markers=[];for(var p=0;p<this.component.locations.length;p++){var r=this.component.locations[p],m=new google.maps.LatLng(r.lat,r.lon),h=new google.maps.Marker({position:m,map:this.map});this.markers.push(h)}}}}});
$.extend(edges,{highcharts:{newPieChartRenderer:function(e){return e||(e={}),edges.highcharts.PieChartRenderer.prototype=edges.newRenderer(e),new edges.highcharts.PieChartRenderer(e)},PieChartRenderer:function(e){this.title=e.title||!1,this.subtitle=e.subtitle||!1,this.showLabels=e.showLabels||!0,this.donut=e.donut||!1,this.toolTipNumberFormat=e.toolTipNumberFormat||",.0f",this.draw=function(){}},newHorizontalMultibarRenderer:function(e){return e||(e={}),edges.highcharts.HorizontalMultibarRenderer.prototype=edges.newRenderer(e),new edges.highcharts.HorizontalMultibarRenderer(e)},HorizontalMultibarRenderer:function(e){this.title=e.title||!1,this.subtitle=e.subtitle||!1,this.draw=function(){}},newMultibarRenderer:function(e){return e||(e={}),edges.highcharts.MultibarRenderer.prototype=edges.newRenderer(e),new edges.highcharts.MultibarRenderer(e)},MultibarRenderer:function(e){this.title=e.title||!1,this.subtitle=e.subtitle||!1,this.yAxisLabel=e.yAxisLabel||!1,this.xAxisLabel=e.xAxisLabel||!1,this.toolTipNumberFormat=e.toolTipNumberFormat||",.0f",this.draw=function(){}},newStackedMultibarRenderer:function(e){return e||(e={}),edges.highcharts.StackedMultibarRenderer.prototype=edges.newRenderer(e),new edges.highcharts.StackedMultibarRenderer(e)},StackedMultibarRenderer:function(e){this.title=e.title||!1,this.subtitle=e.subtitle||!1,this.draw=function(){}}}});
$.extend(edges,{nvd3:{DataSeriesConversions:{toXY:function(e){for(var t=[],i=0;i<e.length;i++){var s=e[i],n={};n.key=s.key,n.values=[];for(var a=0;a<s.values.length;a++){var o=s.values[a];n.values.push({x:o.label,y:o.value})}t.push(n)}return t}},tools:{persistingPieColour:function(e,t){e||(e=["#ea6ccb","#8fc8b0","#a9cf85","#d90d4c","#6c537e","#64d54f","#ecc7c4","#f1712b"]),t||(t={});var i=0;return function(s,n){if(s.label in t)return t[s.label];var a=e[i%(e.length-1)];return i++,t[s.label]=a,a}}},newPieChartRenderer:function(e){return e||(e={}),edges.nvd3.PieChartRenderer.prototype=edges.newRenderer(e),new edges.nvd3.PieChartRenderer(e)},PieChartRenderer:function(e){this.showLabels=e.showLabels||!0,this.donut=e.donut||!1,this.labelThreshold=e.labelThreshold||.05,this.transitionDuration=e.transitionDuration||500,this.noDataMessage=e.noDataMessage||!1,this.color=e.color||!1,this.legendPosition=e.legendPosition||"top",this.labelsOutside=void 0!==e.labelsOutside?e.labelsOutside:!1,this.valueFormat=e.valueFormat||!1,this.marginTop=e.marginTop||30,this.marginRight=e.marginRight||30,this.marginBottom=e.marginBottom||30,this.marginLeft=e.marginLeft||30,this.namespace="edges-nvd3-pie",this.draw=function(){var e=edges.css_classes(this.namespace,"display",this),t="";this.component.display&&(t='<span class="'+e+'">'+this.component.display+"</span><br>");var i=edges.css_id(this.namespace,"svg",this),s=edges.css_id_selector(this.namespace,"svg",this);this.component.context.html(t+'<svg id="'+i+'"></svg>');var n=this.component.dataSeries;n=n.length>0?n[0].values:[];var a=this;nv.addGraph(function(){var e=nv.models.pieChart().x(function(e){return e.label}).y(function(e){return e.value}).showLabels(a.showLabels).legendPosition(a.legendPosition).labelsOutside(a.labelsOutside).margin({left:a.marginLeft,right:a.marginRight,top:a.marginTop,bottom:a.marginBottom});return a.noDataMessage&&e.noData(a.noDataMessage),a.color&&e.color(a.color),a.valueFormat&&e.valueFormat(a.valueFormat),d3.select(s).datum(n).transition().duration(a.transitionDuration).call(e),e})}},newHorizontalMultibarRenderer:function(e){return e||(e={}),edges.nvd3.HorizontalMultibarRenderer.prototype=edges.newRenderer(e),new edges.nvd3.HorizontalMultibarRenderer(e)},HorizontalMultibarRenderer:function(e){this.showValues=e.showValues||!0,this.toolTips=e.toolTips||!0,this.controls=e.controls||!1,this.yTickFormat=e.yTickFormat||",.0f",this.transitionDuration=e.transitionDuration||500,this.marginTop=e.marginTop||30,this.marginRight=e.marginRight||50,this.marginBottom=e.marginBottom||30,this.marginLeft=e.marginLeft||200,this.namespace="edges-nvd3-horizontal-multibar",this.draw=function(){var e=edges.css_id(this.namespace,"svg",this),t=edges.css_id_selector(this.namespace,"svg",this);this.component.context.html('<svg id="'+e+'"></svg>');var i=this.showValues,s=this.toolTips,n=this.controls,a=this.yTickFormat,o=this.transitionDuration,r=this.marginTop,l=this.marginRight,d=this.marginBottom,h=this.marginLeft,c=this.component.dataSeries;nv.addGraph(function(){var e=nv.models.multiBarHorizontalChart().x(function(e){return e.label}).y(function(e){return e.value}).margin({top:r,right:l,bottom:d,left:h}).showValues(i).tooltips(s).showControls(n);return e.yAxis.tickFormat(d3.format(a)),d3.select(t).datum(c).transition().duration(o).call(e),nv.utils.windowResize(e.update),e})}},newMultibarRenderer:function(e){return e||(e={}),edges.nvd3.MultibarRenderer.prototype=edges.newRenderer(e),new edges.nvd3.MultibarRenderer(e)},MultibarRenderer:function(e){this.xTickFormat=e.xTickFormat||",.2f",this.yTickFormat=e.yTickFormat||",.2f",this.transitionDuration=e.transitionDuration||500,this.controls=e.controls||!1,this.barColor=e.barColor||!1,this.showLegend=void 0!==e.showLegend?e.showLegend:!0,this.xAxisLabel=e.xAxisLabel||"",this.yAxisLabel=e.yAxisLabel||"",this.namespace="edges-nvd3-multibar",this.draw=function(){var e=edges.css_classes(this.namespace,"display",this),t="";this.component.display&&(t='<span class="'+e+'">'+this.component.display+"</span><br>");var i=edges.css_id(this.namespace,"svg",this),s=edges.css_id_selector(this.namespace,"svg",this);this.component.context.html(t+'<svg id="'+i+'"></svg>');var n=edges.nvd3.DataSeriesConversions.toXY(this.component.dataSeries),a=this;nv.addGraph(function(){var e=nv.models.multiBarChart().showControls(a.controls);return e.xAxis.axisLabel(a.xAxisLabel).tickFormat(d3.format(a.xTickFormat)),e.yAxis.axisLabel(a.yAxisLabel).tickFormat(d3.format(a.yTickFormat)),a.barColor&&e.barColor(a.barColor),e.showLegend(a.showLegend),d3.select(s).datum(n).transition().duration(a.transitionDuration).call(e),nv.utils.windowResize(e.update),e})}},newSimpleLineChartRenderer:function(e){return e||(e={}),edges.nvd3.SimpleLineChartRenderer.prototype=edges.newRenderer(e),new edges.nvd3.SimpleLineChartRenderer(e)},SimpleLineChartRenderer:function(e){this.interactiveGuideline=e.interactiveGuideline||!0,this.xTickFormat=e.xTickFormat||",.2f",this.yTickFormat=e.yTickFormat||",.2f",this.transitionDuration=e.transitionDuration||500,this.lineColor=e.lineColor||!1,this.includeOnY=e.includeOnY||!1,this.showLegend=void 0!==e.showLegend?e.showLegend:!0,this.xAxisLabel=e.xAxisLabel||"",this.yAxisLabel=e.yAxisLabel||"",this.namespace="edges-nvd3-simple-line-chart",this.draw=function(){var e=edges.css_classes(this.namespace,"display",this),t="";this.component.display&&(t='<span class="'+e+'">'+this.component.display+"</span><br>");var i=edges.css_id(this.namespace,"svg",this),s=edges.css_id_selector(this.namespace,"svg",this);this.component.context.html(t+'<svg id="'+i+'"></svg>');var n=edges.nvd3.DataSeriesConversions.toXY(this.component.dataSeries),a=this;nv.addGraph(function(){var e=nv.models.lineChart().useInteractiveGuideline(a.interactiveGuideline);return e.xAxis.axisLabel(a.xAxisLabel).tickFormat(d3.format(a.xTickFormat)),a.lineColor&&e.color(a.lineColor),a.includeOnY&&e.forceY(a.includeOnY),e.yAxis.axisLabel(a.yAxisLabel).tickFormat(d3.format(a.yTickFormat)),e.showLegend(a.showLegend),d3.select(s).datum(n).transition().duration(a.transitionDuration).call(e),nv.utils.windowResize(e.update),e})}}}});
